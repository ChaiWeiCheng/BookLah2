{"{\"assumptions\":{},\"sourceRoot\":\"C:\\\\Users\\\\teiji\\\\TP Year 2-3 Coding Projects\\\\DevOps Y2\\\\BookLah\\\\tests\\\\\",\"caller\":{\"name\":\"@babel/register\"},\"cwd\":\"C:\\\\Users\\\\teiji\\\\TP Year 2-3 Coding Projects\\\\DevOps Y2\\\\BookLah\",\"filename\":\"C:\\\\Users\\\\teiji\\\\TP Year 2-3 Coding Projects\\\\DevOps Y2\\\\BookLah\\\\tests\\\\bookingTests.test.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"C:\\\\Users\\\\teiji\\\\TP Year 2-3 Coding Projects\\\\DevOps Y2\\\\BookLah\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.23.3:development":{"value":{"code":"const {\n  describe,\n  it\n} = require('mocha');\nconst {\n  expect\n} = require('chai');\nconst sinon = require('sinon');\nconst fs = require('fs').promises;\nconst {\n  viewUserBookings,\n  addBooking,\n  updateBooking\n} = require('../utils/bookingUtil');\nconst {\n  json\n} = require('body-parser');\ndescribe('Testing viewUserBookings Function', () => {\n  const bookingsFilePath = 'utils/bookings.json';\n  var orgContent = \"\";\n  beforeEach(async () => {\n    orgContent = await fs.readFile(bookingsFilePath, 'utf8');\n    orgContent = JSON.parse(orgContent);\n  });\n  it('Should return bookings for the specified user', async () => {\n    const req = {\n      params: {\n        name: 'johnny'\n      }\n    };\n\n    // Spy on the res.json method\n    const jsonSpy = sinon.spy();\n    const res = {\n      status: function (code) {\n        expect(code).to.equal(200);\n        return this;\n      },\n      json: jsonSpy\n    };\n    await viewUserBookings(req, res);\n\n    // Output the value of jsonSpy.firstCall.args[0] to the console for reference\n    // console.log('jsonSpy.firstCall.args[]:', jsonSpy.firstCall.args[0]);\n\n    // Assert that the spy was called with an array\n    expect(jsonSpy.calledOnce).to.be.true;\n    expect(jsonSpy.firstCall.args[0]).to.be.an('array');\n\n    // Assert that the spy was called with every element with the correct name\n    expect(jsonSpy.firstCall.args[0].every(booking => booking.name === req.params.name)).to.be.true;\n  });\n  it('Should return \"No bookings found for the specified user.\" for users with no bookings', async () => {\n    const req = {\n      params: {\n        name: 'NonExistentUser'\n      }\n    };\n\n    // Create spy for res.json\n\n    const jsonSpy = sinon.spy();\n    const res = {\n      status: function (code) {\n        expect(code).to.equal(404);\n        return this;\n      },\n      json: jsonSpy\n    };\n    await viewUserBookings(req, res);\n\n    // Assert that json was called with the expected message\n    expect(jsonSpy.calledWith({\n      message: 'No bookings found for the specified user.'\n    })).to.be.true;\n  });\n});\ndescribe('Testing addBookings Function', () => {\n  const bookingsFilePath = 'utils/bookings.json';\n  var orgContent = \"\";\n  beforeEach(async () => {\n    orgContent = await fs.readFile(bookingsFilePath, 'utf8');\n    orgContent = JSON.parse(orgContent);\n  });\n  afterEach(async () => {\n    await fs.writeFile(bookingsFilePath, JSON.stringify(orgContent), 'utf8');\n  });\n  it('Should add a new booking successfully', async () => {\n    const req = {\n      body: {\n        name: 'johnny',\n        facility: 'Badminton Court',\n        date: '28/11/23',\n        time: '9am - 11pm'\n      }\n    };\n    const res = {\n      status: sinon.stub().returnsThis(),\n      // Creates a stub that returns itself when called. Useful for chaining.\n      json: sinon.stub() //Creates a stub without any specific behavior.\n    };\n\n    await addBooking(req, res);\n\n    // Assert that status was called with the expected code\n    sinon.assert.calledWith(res.status, 201);\n\n    // Assert that json was called with at least one element in the array that matches the expected properties\n    sinon.assert.calledWithMatch(res.json, sinon.match.some(sinon.match({\n      name: req.body.name,\n      facility: req.body.facility,\n      date: req.body.date,\n      time: req.body.time\n    })));\n  });\n  it('Should not be able to add booking due to invalid date format or missing date', async () => {\n    const req = {\n      body: {\n        name: \"johnny\",\n        facility: 'Badminton Court',\n        date: '28/11',\n        time: '1pm - 3pm'\n      }\n    };\n    const jsonSpy = sinon.spy();\n    const res = {\n      status: function (code) {\n        expect(code).to.equal(400);\n        return this;\n      },\n      json: jsonSpy\n    };\n    await addBooking(req, res);\n    expect(jsonSpy.calledWith({\n      message: 'Invalid date format. Please provide a valid date.'\n    })).to.be.true;\n  });\n  it('Should not be able to add booking due to invalid time format or missing time', async () => {\n    const req = {\n      body: {\n        name: \"johnny\",\n        facility: 'Badminton Court',\n        date: '28/11/23'\n      }\n    };\n    const jsonSpy = sinon.spy();\n    const res = {\n      status: function (code) {\n        expect(code).to.equal(400);\n        return this;\n      },\n      json: jsonSpy\n    };\n    await addBooking(req, res);\n    expect(jsonSpy.calledWith({\n      message: 'Invalid time format. Please provide a valid time range.'\n    })).to.be.true;\n  });\n  it('Should not be able to add booking for facility if timing is already booked', async () => {\n    const req = {\n      //a request that is not in bookings.JSON, so we need to use stub to test the scenario\n      body: {\n        name: 'johnny',\n        facility: 'Badminton Court',\n        date: '25/12/23',\n        time: '5pm - 7pm'\n      }\n    };\n\n    // Create a stub for fs.readFile to return predefined bookings\n    //allows me to control the behavior of fs.readFile during the test, \n    //ensuring that it returns specific data I've defined rather than reading from an actual file.\n    const readFileStub = sinon.stub(fs, 'readFile');\n    readFileStub.withArgs(bookingsFilePath, 'utf8').resolves(JSON.stringify([{\n      name: 'johnny',\n      facility: 'Badminton Court',\n      date: '25/12/23',\n      time: '5pm - 7pm'\n    }]));\n    const res = {\n      status: function (code) {\n        expect(code).to.equal(400);\n        return this;\n      },\n      json: function (data) {\n        expect(data.message).to.equal('The chosen time for this facility is already booked by another person. Please choose another timing.');\n      }\n    };\n    await addBooking(req, res);\n\n    // Restore the original function after the test\n    readFileStub.restore();\n  });\n});\ndescribe('Testing updateBookings Function', () => {\n  const bookingsFilePath = 'utils/bookings.json';\n  var orgContent = \"\";\n  beforeEach(async () => {\n    orgContent = await fs.readFile(bookingsFilePath, 'utf8');\n    orgContent = JSON.parse(orgContent);\n  });\n  afterEach(async () => {\n    await fs.writeFile(bookingsFilePath, JSON.stringify(orgContent), 'utf8');\n  });\n  it('Should update booking successfully', async () => {\n    const req = {\n      body: {\n        facility: \"Badminton Court\",\n        date: \"25/12/23\",\n        time: \"7pm - 9pm\"\n      },\n      params: {\n        id: '12345678'\n      }\n    };\n\n    // Create a stub for fs.readFile to return predefined bookings\n    const readFileStub = sinon.stub(fs, 'readFile');\n    readFileStub.withArgs(bookingsFilePath, 'utf8').resolves(JSON.stringify([{\n      name: 'johnny',\n      facility: 'Badminton Court',\n      date: '25/12/23',\n      time: '5pm - 7pm',\n      id: '12345678'\n    }]));\n    const res = {\n      status: function (code) {\n        expect(code).to.equal(201);\n        return this;\n      },\n      json: function (data) {\n        expect(data.message).to.equal('Booking Updated Successfully!');\n      }\n    };\n    await updateBooking(req, res);\n\n    // Restore the original function after the test\n    readFileStub.restore();\n  });\n  it('Should not be able to update booking due to invalid date format or missing date', async () => {\n    const req = {\n      body: {\n        name: \"johnny\",\n        facility: 'Badminton Court',\n        time: '1pm - 3pm'\n      },\n      params: {\n        id: '123456789'\n      }\n    };\n\n    // Create a stub for fs.readFile to return predefined bookings\n    const readFileStub = sinon.stub(fs, 'readFile');\n    readFileStub.withArgs(bookingsFilePath, 'utf8').resolves(JSON.stringify([{\n      name: 'johnny',\n      facility: 'Badminton Court',\n      date: '25/12/23',\n      time: '5pm - 7pm',\n      id: '123456789'\n    }]));\n    const res = {\n      status: function (code) {\n        expect(code).to.equal(400);\n        return this;\n      },\n      json: function (data) {\n        expect(data.message).to.equal('Invalid date format. Please provide a valid date.');\n      }\n    };\n    await updateBooking(req, res);\n\n    // Restore the original function after the test\n    readFileStub.restore();\n  });\n  it('Should not be able to update booking due to invalid time format or missing time', async () => {\n    const req = {\n      body: {\n        name: \"johnny\",\n        facility: 'Badminton Court',\n        date: '28/11/23'\n      },\n      params: {\n        id: '123456789'\n      }\n    };\n\n    // Create a stub for fs.readFile to return predefined bookings\n    const readFileStub = sinon.stub(fs, 'readFile');\n    readFileStub.withArgs(bookingsFilePath, 'utf8').resolves(JSON.stringify([{\n      name: 'johnny',\n      facility: 'Badminton Court',\n      date: '25/12/23',\n      time: '5pm - 7pm',\n      id: '123456789'\n    }]));\n    const res = {\n      status: function (code) {\n        expect(code).to.equal(400);\n        return this;\n      },\n      json: function (data) {\n        expect(data.message).to.equal('Invalid time format. Please provide a valid time range.');\n      }\n    };\n    await updateBooking(req, res);\n\n    // Restore the original function after the test\n    readFileStub.restore();\n  });\n  it('Should not be able to update booking due to conflict with another booking', async () => {\n    const req = {\n      body: {\n        facility: \"Badminton Court\",\n        date: \"27/12/23\",\n        time: \"5pm - 7pm\"\n      },\n      params: {\n        id: '123456789'\n      }\n    };\n\n    // Create a mock for fs module\n    const fsMock = sinon.mock(fs);\n\n    // Expect readFile to be called with specific arguments and resolve with predefined bookings\n    //I expect the readFile function to be called with specific arguments, and when it is called, \n    //it should resolve with a predefined array of bookings.\n    fsMock.expects('readFile').withArgs(bookingsFilePath, 'utf8').resolves(JSON.stringify([{\n      name: 'johnny',\n      facility: 'Badminton Court',\n      date: '25/12/23',\n      time: '5pm - 7pm',\n      id: '123456789'\n    }, {\n      name: 'danial',\n      facility: 'Badminton Court',\n      date: '27/12/23',\n      time: '5pm - 7pm',\n      id: '12345678910'\n    }]));\n    const res = {\n      status: function (code) {\n        expect(code).to.equal(400);\n        return this;\n      },\n      json: function (data) {\n        expect(data.message).to.equal('The chosen time for this facility is already booked by another person. Please choose another timing.');\n      }\n    };\n    await updateBooking(req, res);\n\n    // Verify that expectations are met\n    fsMock.verify();\n\n    // Restore the original function after the test\n    fsMock.restore();\n  });\n  it('Should not be able to update booking due to invalid id', async () => {\n    const req = {\n      body: {\n        facility: \"Badminton Court\",\n        date: \"30/11/23\",\n        time: \"9am - 11am\"\n      },\n      params: {\n        id: \"1234567\"\n      }\n    };\n\n    // Create a stub for fs.readFile to return predefined bookings\n    const readFileStub = sinon.stub(fs, 'readFile');\n    readFileStub.withArgs(bookingsFilePath, 'utf8').resolves(JSON.stringify([{\n      name: 'johnny',\n      facility: 'Badminton Court',\n      date: '25/12/23',\n      time: '5pm - 7pm',\n      id: '123456789'\n    }, {\n      name: 'danial',\n      facility: 'Badminton Court',\n      date: '27/12/23',\n      time: '5pm - 7pm',\n      id: '12345678910'\n    }]));\n    const res = {\n      status: function (code) {\n        expect(code).to.equal(500);\n        return this;\n      },\n      json: function (data) {\n        expect(data.message).to.equal('Error occurred, unable to Update!');\n      }\n    };\n    await updateBooking(req, res);\n\n    // Restore the original function after the test\n    readFileStub.restore();\n  });\n});\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJkZXNjcmliZSIsIml0IiwicmVxdWlyZSIsImV4cGVjdCIsInNpbm9uIiwiZnMiLCJwcm9taXNlcyIsInZpZXdVc2VyQm9va2luZ3MiLCJhZGRCb29raW5nIiwidXBkYXRlQm9va2luZyIsImpzb24iLCJib29raW5nc0ZpbGVQYXRoIiwib3JnQ29udGVudCIsImJlZm9yZUVhY2giLCJyZWFkRmlsZSIsIkpTT04iLCJwYXJzZSIsInJlcSIsInBhcmFtcyIsIm5hbWUiLCJqc29uU3B5Iiwic3B5IiwicmVzIiwic3RhdHVzIiwiY29kZSIsInRvIiwiZXF1YWwiLCJjYWxsZWRPbmNlIiwiYmUiLCJ0cnVlIiwiZmlyc3RDYWxsIiwiYXJncyIsImFuIiwiZXZlcnkiLCJib29raW5nIiwiY2FsbGVkV2l0aCIsIm1lc3NhZ2UiLCJhZnRlckVhY2giLCJ3cml0ZUZpbGUiLCJzdHJpbmdpZnkiLCJib2R5IiwiZmFjaWxpdHkiLCJkYXRlIiwidGltZSIsInN0dWIiLCJyZXR1cm5zVGhpcyIsImFzc2VydCIsImNhbGxlZFdpdGhNYXRjaCIsIm1hdGNoIiwic29tZSIsInJlYWRGaWxlU3R1YiIsIndpdGhBcmdzIiwicmVzb2x2ZXMiLCJkYXRhIiwicmVzdG9yZSIsImlkIiwiZnNNb2NrIiwibW9jayIsImV4cGVjdHMiLCJ2ZXJpZnkiXSwic291cmNlUm9vdCI6IkM6XFxVc2Vyc1xcdGVpamlcXFRQIFllYXIgMi0zIENvZGluZyBQcm9qZWN0c1xcRGV2T3BzIFkyXFxCb29rTGFoXFx0ZXN0c1xcIiwic291cmNlcyI6WyJib29raW5nVGVzdHMudGVzdC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCB7IGRlc2NyaWJlLCBpdCB9ID0gcmVxdWlyZSgnbW9jaGEnKTtcclxuY29uc3QgeyBleHBlY3QgfSA9IHJlcXVpcmUoJ2NoYWknKTtcclxuY29uc3Qgc2lub24gPSByZXF1aXJlKCdzaW5vbicpO1xyXG5jb25zdCBmcyA9IHJlcXVpcmUoJ2ZzJykucHJvbWlzZXM7XHJcbmNvbnN0IHsgdmlld1VzZXJCb29raW5ncywgYWRkQm9va2luZywgdXBkYXRlQm9va2luZyB9ID0gcmVxdWlyZSgnLi4vdXRpbHMvYm9va2luZ1V0aWwnKTtcclxuY29uc3QgeyBqc29uIH0gPSByZXF1aXJlKCdib2R5LXBhcnNlcicpO1xyXG5cclxuZGVzY3JpYmUoJ1Rlc3Rpbmcgdmlld1VzZXJCb29raW5ncyBGdW5jdGlvbicsICgpID0+IHtcclxuICAgIGNvbnN0IGJvb2tpbmdzRmlsZVBhdGggPSAndXRpbHMvYm9va2luZ3MuanNvbic7XHJcbiAgICB2YXIgb3JnQ29udGVudCA9IFwiXCI7XHJcblxyXG4gICAgYmVmb3JlRWFjaChhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgb3JnQ29udGVudCA9IGF3YWl0IGZzLnJlYWRGaWxlKGJvb2tpbmdzRmlsZVBhdGgsICd1dGY4Jyk7XHJcbiAgICAgICAgb3JnQ29udGVudCA9IEpTT04ucGFyc2Uob3JnQ29udGVudCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnU2hvdWxkIHJldHVybiBib29raW5ncyBmb3IgdGhlIHNwZWNpZmllZCB1c2VyJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgIGNvbnN0IHJlcSA9IHtcclxuICAgICAgICAgICAgcGFyYW1zOiB7IG5hbWU6ICdqb2hubnknIH0sXHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgLy8gU3B5IG9uIHRoZSByZXMuanNvbiBtZXRob2RcclxuICAgICAgICBjb25zdCBqc29uU3B5ID0gc2lub24uc3B5KCk7XHJcblxyXG4gICAgICAgIGNvbnN0IHJlcyA9IHtcclxuICAgICAgICAgICAgc3RhdHVzOiBmdW5jdGlvbiAoY29kZSkge1xyXG4gICAgICAgICAgICAgICAgZXhwZWN0KGNvZGUpLnRvLmVxdWFsKDIwMCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAganNvbjoganNvblNweSxcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICBhd2FpdCB2aWV3VXNlckJvb2tpbmdzKHJlcSwgcmVzKTtcclxuXHJcbiAgICAgICAgLy8gT3V0cHV0IHRoZSB2YWx1ZSBvZiBqc29uU3B5LmZpcnN0Q2FsbC5hcmdzWzBdIHRvIHRoZSBjb25zb2xlIGZvciByZWZlcmVuY2VcclxuICAgICAgICAvLyBjb25zb2xlLmxvZygnanNvblNweS5maXJzdENhbGwuYXJnc1tdOicsIGpzb25TcHkuZmlyc3RDYWxsLmFyZ3NbMF0pO1xyXG5cclxuICAgICAgICAvLyBBc3NlcnQgdGhhdCB0aGUgc3B5IHdhcyBjYWxsZWQgd2l0aCBhbiBhcnJheVxyXG4gICAgICAgIGV4cGVjdChqc29uU3B5LmNhbGxlZE9uY2UpLnRvLmJlLnRydWU7XHJcbiAgICAgICAgZXhwZWN0KGpzb25TcHkuZmlyc3RDYWxsLmFyZ3NbMF0pLnRvLmJlLmFuKCdhcnJheScpO1xyXG5cclxuICAgICAgICAvLyBBc3NlcnQgdGhhdCB0aGUgc3B5IHdhcyBjYWxsZWQgd2l0aCBldmVyeSBlbGVtZW50IHdpdGggdGhlIGNvcnJlY3QgbmFtZVxyXG4gICAgICAgIGV4cGVjdChqc29uU3B5LmZpcnN0Q2FsbC5hcmdzWzBdLmV2ZXJ5KGJvb2tpbmcgPT4gYm9va2luZy5uYW1lID09PSByZXEucGFyYW1zLm5hbWUpKS50by5iZS50cnVlO1xyXG5cclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdTaG91bGQgcmV0dXJuIFwiTm8gYm9va2luZ3MgZm91bmQgZm9yIHRoZSBzcGVjaWZpZWQgdXNlci5cIiBmb3IgdXNlcnMgd2l0aCBubyBib29raW5ncycsIGFzeW5jICgpID0+IHtcclxuICAgICAgICBjb25zdCByZXEgPSB7XHJcbiAgICAgICAgICAgIHBhcmFtczogeyBuYW1lOiAnTm9uRXhpc3RlbnRVc2VyJyB9LFxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIC8vIENyZWF0ZSBzcHkgZm9yIHJlcy5qc29uXHJcblxyXG4gICAgICAgIGNvbnN0IGpzb25TcHkgPSBzaW5vbi5zcHkoKTtcclxuXHJcbiAgICAgICAgY29uc3QgcmVzID0ge1xyXG4gICAgICAgICAgICBzdGF0dXM6IGZ1bmN0aW9uIChjb2RlKSB7XHJcbiAgICAgICAgICAgICAgICBleHBlY3QoY29kZSkudG8uZXF1YWwoNDA0KTtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBqc29uOiBqc29uU3B5LFxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIGF3YWl0IHZpZXdVc2VyQm9va2luZ3MocmVxLCByZXMpO1xyXG5cclxuICAgICAgICAvLyBBc3NlcnQgdGhhdCBqc29uIHdhcyBjYWxsZWQgd2l0aCB0aGUgZXhwZWN0ZWQgbWVzc2FnZVxyXG4gICAgICAgIGV4cGVjdChqc29uU3B5LmNhbGxlZFdpdGgoeyBtZXNzYWdlOiAnTm8gYm9va2luZ3MgZm91bmQgZm9yIHRoZSBzcGVjaWZpZWQgdXNlci4nIH0pKS50by5iZS50cnVlO1xyXG5cclxuXHJcbiAgICB9KTtcclxuXHJcbn0pO1xyXG5cclxuZGVzY3JpYmUoJ1Rlc3RpbmcgYWRkQm9va2luZ3MgRnVuY3Rpb24nLCAoKSA9PiB7XHJcbiAgICBjb25zdCBib29raW5nc0ZpbGVQYXRoID0gJ3V0aWxzL2Jvb2tpbmdzLmpzb24nO1xyXG4gICAgdmFyIG9yZ0NvbnRlbnQgPSBcIlwiO1xyXG5cclxuICAgIGJlZm9yZUVhY2goYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgIG9yZ0NvbnRlbnQgPSBhd2FpdCBmcy5yZWFkRmlsZShib29raW5nc0ZpbGVQYXRoLCAndXRmOCcpO1xyXG4gICAgICAgIG9yZ0NvbnRlbnQgPSBKU09OLnBhcnNlKG9yZ0NvbnRlbnQpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgYWZ0ZXJFYWNoKGFzeW5jICgpID0+IHtcclxuICAgICAgICBhd2FpdCBmcy53cml0ZUZpbGUoYm9va2luZ3NGaWxlUGF0aCwgSlNPTi5zdHJpbmdpZnkob3JnQ29udGVudCksICd1dGY4Jyk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnU2hvdWxkIGFkZCBhIG5ldyBib29raW5nIHN1Y2Nlc3NmdWxseScsIGFzeW5jICgpID0+IHtcclxuICAgICAgICBjb25zdCByZXEgPSB7XHJcbiAgICAgICAgICAgIGJvZHk6IHtcclxuICAgICAgICAgICAgICAgIG5hbWU6ICdqb2hubnknLFxyXG4gICAgICAgICAgICAgICAgZmFjaWxpdHk6ICdCYWRtaW50b24gQ291cnQnLFxyXG4gICAgICAgICAgICAgICAgZGF0ZTogJzI4LzExLzIzJyxcclxuICAgICAgICAgICAgICAgIHRpbWU6ICc5YW0gLSAxMXBtJyxcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICBjb25zdCByZXMgPSB7XHJcbiAgICAgICAgICAgIHN0YXR1czogc2lub24uc3R1YigpLnJldHVybnNUaGlzKCksICAvLyBDcmVhdGVzIGEgc3R1YiB0aGF0IHJldHVybnMgaXRzZWxmIHdoZW4gY2FsbGVkLiBVc2VmdWwgZm9yIGNoYWluaW5nLlxyXG4gICAgICAgICAgICBqc29uOiBzaW5vbi5zdHViKCksIC8vQ3JlYXRlcyBhIHN0dWIgd2l0aG91dCBhbnkgc3BlY2lmaWMgYmVoYXZpb3IuXHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgYXdhaXQgYWRkQm9va2luZyhyZXEsIHJlcyk7XHJcblxyXG4gICAgICAgIC8vIEFzc2VydCB0aGF0IHN0YXR1cyB3YXMgY2FsbGVkIHdpdGggdGhlIGV4cGVjdGVkIGNvZGVcclxuICAgICAgICBzaW5vbi5hc3NlcnQuY2FsbGVkV2l0aChyZXMuc3RhdHVzLCAyMDEpO1xyXG5cclxuICAgICAgICAvLyBBc3NlcnQgdGhhdCBqc29uIHdhcyBjYWxsZWQgd2l0aCBhdCBsZWFzdCBvbmUgZWxlbWVudCBpbiB0aGUgYXJyYXkgdGhhdCBtYXRjaGVzIHRoZSBleHBlY3RlZCBwcm9wZXJ0aWVzXHJcbiAgICAgICAgc2lub24uYXNzZXJ0LmNhbGxlZFdpdGhNYXRjaChyZXMuanNvbiwgc2lub24ubWF0Y2guc29tZShzaW5vbi5tYXRjaCh7XHJcbiAgICAgICAgICAgIG5hbWU6IHJlcS5ib2R5Lm5hbWUsXHJcbiAgICAgICAgICAgIGZhY2lsaXR5OiByZXEuYm9keS5mYWNpbGl0eSxcclxuICAgICAgICAgICAgZGF0ZTogcmVxLmJvZHkuZGF0ZSxcclxuICAgICAgICAgICAgdGltZTogcmVxLmJvZHkudGltZSxcclxuICAgICAgICB9KSkpO1xyXG5cclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdTaG91bGQgbm90IGJlIGFibGUgdG8gYWRkIGJvb2tpbmcgZHVlIHRvIGludmFsaWQgZGF0ZSBmb3JtYXQgb3IgbWlzc2luZyBkYXRlJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgIGNvbnN0IHJlcSA9IHtcclxuICAgICAgICAgICAgYm9keToge1xyXG4gICAgICAgICAgICAgICAgbmFtZTogXCJqb2hubnlcIixcclxuICAgICAgICAgICAgICAgIGZhY2lsaXR5OiAnQmFkbWludG9uIENvdXJ0JyxcclxuICAgICAgICAgICAgICAgIGRhdGU6ICcyOC8xMScsXHJcbiAgICAgICAgICAgICAgICB0aW1lOiAnMXBtIC0gM3BtJyxcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICBjb25zdCBqc29uU3B5ID0gc2lub24uc3B5KCk7XHJcblxyXG4gICAgICAgIGNvbnN0IHJlcyA9IHtcclxuICAgICAgICAgICAgc3RhdHVzOiBmdW5jdGlvbiAoY29kZSkge1xyXG4gICAgICAgICAgICAgICAgZXhwZWN0KGNvZGUpLnRvLmVxdWFsKDQwMCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAganNvbjoganNvblNweSxcclxuICAgICAgICB9O1xyXG4gICAgICAgIGF3YWl0IGFkZEJvb2tpbmcocmVxLCByZXMpO1xyXG5cclxuICAgICAgICBleHBlY3QoanNvblNweS5jYWxsZWRXaXRoKHsgbWVzc2FnZTogJ0ludmFsaWQgZGF0ZSBmb3JtYXQuIFBsZWFzZSBwcm92aWRlIGEgdmFsaWQgZGF0ZS4nIH0pKS50by5iZS50cnVlO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ1Nob3VsZCBub3QgYmUgYWJsZSB0byBhZGQgYm9va2luZyBkdWUgdG8gaW52YWxpZCB0aW1lIGZvcm1hdCBvciBtaXNzaW5nIHRpbWUnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgY29uc3QgcmVxID0ge1xyXG4gICAgICAgICAgICBib2R5OiB7XHJcbiAgICAgICAgICAgICAgICBuYW1lOiBcImpvaG5ueVwiLFxyXG4gICAgICAgICAgICAgICAgZmFjaWxpdHk6ICdCYWRtaW50b24gQ291cnQnLFxyXG4gICAgICAgICAgICAgICAgZGF0ZTogJzI4LzExLzIzJyxcclxuXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgY29uc3QganNvblNweSA9IHNpbm9uLnNweSgpO1xyXG5cclxuICAgICAgICBjb25zdCByZXMgPSB7XHJcbiAgICAgICAgICAgIHN0YXR1czogZnVuY3Rpb24gKGNvZGUpIHtcclxuICAgICAgICAgICAgICAgIGV4cGVjdChjb2RlKS50by5lcXVhbCg0MDApO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGpzb246IGpzb25TcHksXHJcbiAgICAgICAgfTtcclxuICAgICAgICBhd2FpdCBhZGRCb29raW5nKHJlcSwgcmVzKTtcclxuXHJcbiAgICAgICAgZXhwZWN0KGpzb25TcHkuY2FsbGVkV2l0aCh7IG1lc3NhZ2U6ICdJbnZhbGlkIHRpbWUgZm9ybWF0LiBQbGVhc2UgcHJvdmlkZSBhIHZhbGlkIHRpbWUgcmFuZ2UuJyB9KSkudG8uYmUudHJ1ZTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdTaG91bGQgbm90IGJlIGFibGUgdG8gYWRkIGJvb2tpbmcgZm9yIGZhY2lsaXR5IGlmIHRpbWluZyBpcyBhbHJlYWR5IGJvb2tlZCcsIGFzeW5jICgpID0+IHtcclxuICAgICAgICBjb25zdCByZXEgPSB7XHJcblxyXG4gICAgICAgICAgICAvL2EgcmVxdWVzdCB0aGF0IGlzIG5vdCBpbiBib29raW5ncy5KU09OLCBzbyB3ZSBuZWVkIHRvIHVzZSBzdHViIHRvIHRlc3QgdGhlIHNjZW5hcmlvXHJcbiAgICAgICAgICAgIGJvZHk6IHtcclxuICAgICAgICAgICAgICAgIG5hbWU6ICdqb2hubnknLFxyXG4gICAgICAgICAgICAgICAgZmFjaWxpdHk6ICdCYWRtaW50b24gQ291cnQnLFxyXG4gICAgICAgICAgICAgICAgZGF0ZTogJzI1LzEyLzIzJyxcclxuICAgICAgICAgICAgICAgIHRpbWU6ICc1cG0gLSA3cG0nLFxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIC8vIENyZWF0ZSBhIHN0dWIgZm9yIGZzLnJlYWRGaWxlIHRvIHJldHVybiBwcmVkZWZpbmVkIGJvb2tpbmdzXHJcbiAgICAgICAgLy9hbGxvd3MgbWUgdG8gY29udHJvbCB0aGUgYmVoYXZpb3Igb2YgZnMucmVhZEZpbGUgZHVyaW5nIHRoZSB0ZXN0LCBcclxuICAgICAgICAvL2Vuc3VyaW5nIHRoYXQgaXQgcmV0dXJucyBzcGVjaWZpYyBkYXRhIEkndmUgZGVmaW5lZCByYXRoZXIgdGhhbiByZWFkaW5nIGZyb20gYW4gYWN0dWFsIGZpbGUuXHJcbiAgICAgICAgY29uc3QgcmVhZEZpbGVTdHViID0gc2lub24uc3R1YihmcywgJ3JlYWRGaWxlJyk7XHJcbiAgICAgICAgcmVhZEZpbGVTdHViLndpdGhBcmdzKGJvb2tpbmdzRmlsZVBhdGgsICd1dGY4JykucmVzb2x2ZXMoSlNPTi5zdHJpbmdpZnkoW1xyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBuYW1lOiAnam9obm55JyxcclxuICAgICAgICAgICAgICAgIGZhY2lsaXR5OiAnQmFkbWludG9uIENvdXJ0JyxcclxuICAgICAgICAgICAgICAgIGRhdGU6ICcyNS8xMi8yMycsXHJcbiAgICAgICAgICAgICAgICB0aW1lOiAnNXBtIC0gN3BtJyxcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICBdKSk7XHJcblxyXG4gICAgICAgIGNvbnN0IHJlcyA9IHtcclxuICAgICAgICAgICAgc3RhdHVzOiBmdW5jdGlvbiAoY29kZSkge1xyXG4gICAgICAgICAgICAgICAgZXhwZWN0KGNvZGUpLnRvLmVxdWFsKDQwMCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAganNvbjogZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgIGV4cGVjdChkYXRhLm1lc3NhZ2UpLnRvLmVxdWFsKCdUaGUgY2hvc2VuIHRpbWUgZm9yIHRoaXMgZmFjaWxpdHkgaXMgYWxyZWFkeSBib29rZWQgYnkgYW5vdGhlciBwZXJzb24uIFBsZWFzZSBjaG9vc2UgYW5vdGhlciB0aW1pbmcuJyk7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgYXdhaXQgYWRkQm9va2luZyhyZXEsIHJlcyk7XHJcblxyXG4gICAgICAgIC8vIFJlc3RvcmUgdGhlIG9yaWdpbmFsIGZ1bmN0aW9uIGFmdGVyIHRoZSB0ZXN0XHJcbiAgICAgICAgcmVhZEZpbGVTdHViLnJlc3RvcmUoKTtcclxuICAgIH0pO1xyXG5cclxufSk7XHJcblxyXG5kZXNjcmliZSgnVGVzdGluZyB1cGRhdGVCb29raW5ncyBGdW5jdGlvbicsICgpID0+IHtcclxuICAgIGNvbnN0IGJvb2tpbmdzRmlsZVBhdGggPSAndXRpbHMvYm9va2luZ3MuanNvbic7XHJcbiAgICB2YXIgb3JnQ29udGVudCA9IFwiXCI7XHJcblxyXG4gICAgYmVmb3JlRWFjaChhc3luYyAoKSA9PiB7XHJcblxyXG4gICAgICAgIG9yZ0NvbnRlbnQgPSBhd2FpdCBmcy5yZWFkRmlsZShib29raW5nc0ZpbGVQYXRoLCAndXRmOCcpO1xyXG4gICAgICAgIG9yZ0NvbnRlbnQgPSBKU09OLnBhcnNlKG9yZ0NvbnRlbnQpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgYWZ0ZXJFYWNoKGFzeW5jICgpID0+IHtcclxuICAgICAgICBhd2FpdCBmcy53cml0ZUZpbGUoYm9va2luZ3NGaWxlUGF0aCwgSlNPTi5zdHJpbmdpZnkob3JnQ29udGVudCksICd1dGY4Jyk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnU2hvdWxkIHVwZGF0ZSBib29raW5nIHN1Y2Nlc3NmdWxseScsIGFzeW5jICgpID0+IHtcclxuICAgICAgICBjb25zdCByZXEgPSB7XHJcbiAgICAgICAgICAgIGJvZHk6IHtcclxuICAgICAgICAgICAgICAgIGZhY2lsaXR5OiBcIkJhZG1pbnRvbiBDb3VydFwiLFxyXG4gICAgICAgICAgICAgICAgZGF0ZTogXCIyNS8xMi8yM1wiLFxyXG4gICAgICAgICAgICAgICAgdGltZTogXCI3cG0gLSA5cG1cIixcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgcGFyYW1zOiB7XHJcbiAgICAgICAgICAgICAgICBpZDogJzEyMzQ1Njc4J1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgLy8gQ3JlYXRlIGEgc3R1YiBmb3IgZnMucmVhZEZpbGUgdG8gcmV0dXJuIHByZWRlZmluZWQgYm9va2luZ3NcclxuICAgICAgICBjb25zdCByZWFkRmlsZVN0dWIgPSBzaW5vbi5zdHViKGZzLCAncmVhZEZpbGUnKTtcclxuICAgICAgICByZWFkRmlsZVN0dWIud2l0aEFyZ3MoYm9va2luZ3NGaWxlUGF0aCwgJ3V0ZjgnKS5yZXNvbHZlcyhKU09OLnN0cmluZ2lmeShbXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIG5hbWU6ICdqb2hubnknLFxyXG4gICAgICAgICAgICAgICAgZmFjaWxpdHk6ICdCYWRtaW50b24gQ291cnQnLFxyXG4gICAgICAgICAgICAgICAgZGF0ZTogJzI1LzEyLzIzJyxcclxuICAgICAgICAgICAgICAgIHRpbWU6ICc1cG0gLSA3cG0nLFxyXG4gICAgICAgICAgICAgICAgaWQ6ICcxMjM0NTY3OCcsXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgXSkpO1xyXG5cclxuICAgICAgICBjb25zdCByZXMgPSB7XHJcbiAgICAgICAgICAgIHN0YXR1czogZnVuY3Rpb24gKGNvZGUpIHtcclxuICAgICAgICAgICAgICAgIGV4cGVjdChjb2RlKS50by5lcXVhbCgyMDEpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGpzb246IGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICBleHBlY3QoZGF0YS5tZXNzYWdlKS50by5lcXVhbCgnQm9va2luZyBVcGRhdGVkIFN1Y2Nlc3NmdWxseSEnKTtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICBhd2FpdCB1cGRhdGVCb29raW5nKHJlcSwgcmVzKTtcclxuXHJcbiAgICAgICAgLy8gUmVzdG9yZSB0aGUgb3JpZ2luYWwgZnVuY3Rpb24gYWZ0ZXIgdGhlIHRlc3RcclxuICAgICAgICByZWFkRmlsZVN0dWIucmVzdG9yZSgpO1xyXG5cclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdTaG91bGQgbm90IGJlIGFibGUgdG8gdXBkYXRlIGJvb2tpbmcgZHVlIHRvIGludmFsaWQgZGF0ZSBmb3JtYXQgb3IgbWlzc2luZyBkYXRlJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgIGNvbnN0IHJlcSA9IHtcclxuICAgICAgICAgICAgYm9keToge1xyXG4gICAgICAgICAgICAgICAgbmFtZTogXCJqb2hubnlcIixcclxuICAgICAgICAgICAgICAgIGZhY2lsaXR5OiAnQmFkbWludG9uIENvdXJ0JyxcclxuICAgICAgICAgICAgICAgIHRpbWU6ICcxcG0gLSAzcG0nLFxyXG4gICAgICAgICAgICB9LFxyXG5cclxuICAgICAgICAgICAgcGFyYW1zOiB7XHJcbiAgICAgICAgICAgICAgICBpZDogJzEyMzQ1Njc4OSdcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIC8vIENyZWF0ZSBhIHN0dWIgZm9yIGZzLnJlYWRGaWxlIHRvIHJldHVybiBwcmVkZWZpbmVkIGJvb2tpbmdzXHJcbiAgICAgICAgY29uc3QgcmVhZEZpbGVTdHViID0gc2lub24uc3R1YihmcywgJ3JlYWRGaWxlJyk7XHJcbiAgICAgICAgcmVhZEZpbGVTdHViLndpdGhBcmdzKGJvb2tpbmdzRmlsZVBhdGgsICd1dGY4JykucmVzb2x2ZXMoSlNPTi5zdHJpbmdpZnkoW1xyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBuYW1lOiAnam9obm55JyxcclxuICAgICAgICAgICAgICAgIGZhY2lsaXR5OiAnQmFkbWludG9uIENvdXJ0JyxcclxuICAgICAgICAgICAgICAgIGRhdGU6ICcyNS8xMi8yMycsXHJcbiAgICAgICAgICAgICAgICB0aW1lOiAnNXBtIC0gN3BtJyxcclxuICAgICAgICAgICAgICAgIGlkOiAnMTIzNDU2Nzg5JyxcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICBdKSk7XHJcblxyXG4gICAgICAgIGNvbnN0IHJlcyA9IHtcclxuICAgICAgICAgICAgc3RhdHVzOiBmdW5jdGlvbiAoY29kZSkge1xyXG4gICAgICAgICAgICAgICAgZXhwZWN0KGNvZGUpLnRvLmVxdWFsKDQwMCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAganNvbjogZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgIGV4cGVjdChkYXRhLm1lc3NhZ2UpLnRvLmVxdWFsKCdJbnZhbGlkIGRhdGUgZm9ybWF0LiBQbGVhc2UgcHJvdmlkZSBhIHZhbGlkIGRhdGUuJyk7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgfTtcclxuICAgICAgICBhd2FpdCB1cGRhdGVCb29raW5nKHJlcSwgcmVzKTtcclxuXHJcbiAgICAgICAgLy8gUmVzdG9yZSB0aGUgb3JpZ2luYWwgZnVuY3Rpb24gYWZ0ZXIgdGhlIHRlc3RcclxuICAgICAgICByZWFkRmlsZVN0dWIucmVzdG9yZSgpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ1Nob3VsZCBub3QgYmUgYWJsZSB0byB1cGRhdGUgYm9va2luZyBkdWUgdG8gaW52YWxpZCB0aW1lIGZvcm1hdCBvciBtaXNzaW5nIHRpbWUnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgY29uc3QgcmVxID0ge1xyXG4gICAgICAgICAgICBib2R5OiB7XHJcbiAgICAgICAgICAgICAgICBuYW1lOiBcImpvaG5ueVwiLFxyXG4gICAgICAgICAgICAgICAgZmFjaWxpdHk6ICdCYWRtaW50b24gQ291cnQnLFxyXG4gICAgICAgICAgICAgICAgZGF0ZTogJzI4LzExLzIzJyxcclxuICAgICAgICAgICAgfSxcclxuXHJcbiAgICAgICAgICAgIHBhcmFtczoge1xyXG4gICAgICAgICAgICAgICAgaWQ6ICcxMjM0NTY3ODknXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICAvLyBDcmVhdGUgYSBzdHViIGZvciBmcy5yZWFkRmlsZSB0byByZXR1cm4gcHJlZGVmaW5lZCBib29raW5nc1xyXG4gICAgICAgIGNvbnN0IHJlYWRGaWxlU3R1YiA9IHNpbm9uLnN0dWIoZnMsICdyZWFkRmlsZScpO1xyXG4gICAgICAgIHJlYWRGaWxlU3R1Yi53aXRoQXJncyhib29raW5nc0ZpbGVQYXRoLCAndXRmOCcpLnJlc29sdmVzKEpTT04uc3RyaW5naWZ5KFtcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgbmFtZTogJ2pvaG5ueScsXHJcbiAgICAgICAgICAgICAgICBmYWNpbGl0eTogJ0JhZG1pbnRvbiBDb3VydCcsXHJcbiAgICAgICAgICAgICAgICBkYXRlOiAnMjUvMTIvMjMnLFxyXG4gICAgICAgICAgICAgICAgdGltZTogJzVwbSAtIDdwbScsXHJcbiAgICAgICAgICAgICAgICBpZDogJzEyMzQ1Njc4OScsXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgXSkpO1xyXG5cclxuICAgICAgICBjb25zdCByZXMgPSB7XHJcbiAgICAgICAgICAgIHN0YXR1czogZnVuY3Rpb24gKGNvZGUpIHtcclxuICAgICAgICAgICAgICAgIGV4cGVjdChjb2RlKS50by5lcXVhbCg0MDApO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGpzb246IGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICBleHBlY3QoZGF0YS5tZXNzYWdlKS50by5lcXVhbCgnSW52YWxpZCB0aW1lIGZvcm1hdC4gUGxlYXNlIHByb3ZpZGUgYSB2YWxpZCB0aW1lIHJhbmdlLicpO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgIH07XHJcbiAgICAgICAgYXdhaXQgdXBkYXRlQm9va2luZyhyZXEsIHJlcyk7XHJcblxyXG4gICAgICAgIC8vIFJlc3RvcmUgdGhlIG9yaWdpbmFsIGZ1bmN0aW9uIGFmdGVyIHRoZSB0ZXN0XHJcbiAgICAgICAgcmVhZEZpbGVTdHViLnJlc3RvcmUoKTtcclxuXHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnU2hvdWxkIG5vdCBiZSBhYmxlIHRvIHVwZGF0ZSBib29raW5nIGR1ZSB0byBjb25mbGljdCB3aXRoIGFub3RoZXIgYm9va2luZycsIGFzeW5jICgpID0+IHtcclxuICAgICAgICBjb25zdCByZXEgPSB7XHJcbiAgICAgICAgICAgIGJvZHk6IHtcclxuICAgICAgICAgICAgICAgIGZhY2lsaXR5OiBcIkJhZG1pbnRvbiBDb3VydFwiLFxyXG4gICAgICAgICAgICAgICAgZGF0ZTogXCIyNy8xMi8yM1wiLFxyXG4gICAgICAgICAgICAgICAgdGltZTogXCI1cG0gLSA3cG1cIixcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgcGFyYW1zOiB7XHJcbiAgICAgICAgICAgICAgICBpZDogJzEyMzQ1Njc4OSdcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIC8vIENyZWF0ZSBhIG1vY2sgZm9yIGZzIG1vZHVsZVxyXG4gICAgICAgIGNvbnN0IGZzTW9jayA9IHNpbm9uLm1vY2soZnMpO1xyXG5cclxuICAgICAgICAvLyBFeHBlY3QgcmVhZEZpbGUgdG8gYmUgY2FsbGVkIHdpdGggc3BlY2lmaWMgYXJndW1lbnRzIGFuZCByZXNvbHZlIHdpdGggcHJlZGVmaW5lZCBib29raW5nc1xyXG4gICAgICAgIC8vSSBleHBlY3QgdGhlIHJlYWRGaWxlIGZ1bmN0aW9uIHRvIGJlIGNhbGxlZCB3aXRoIHNwZWNpZmljIGFyZ3VtZW50cywgYW5kIHdoZW4gaXQgaXMgY2FsbGVkLCBcclxuICAgICAgICAvL2l0IHNob3VsZCByZXNvbHZlIHdpdGggYSBwcmVkZWZpbmVkIGFycmF5IG9mIGJvb2tpbmdzLlxyXG4gICAgICAgIGZzTW9jay5leHBlY3RzKCdyZWFkRmlsZScpXHJcbiAgICAgICAgICAgIC53aXRoQXJncyhib29raW5nc0ZpbGVQYXRoLCAndXRmOCcpXHJcbiAgICAgICAgICAgIC5yZXNvbHZlcyhKU09OLnN0cmluZ2lmeShbXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogJ2pvaG5ueScsXHJcbiAgICAgICAgICAgICAgICAgICAgZmFjaWxpdHk6ICdCYWRtaW50b24gQ291cnQnLFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGU6ICcyNS8xMi8yMycsXHJcbiAgICAgICAgICAgICAgICAgICAgdGltZTogJzVwbSAtIDdwbScsXHJcbiAgICAgICAgICAgICAgICAgICAgaWQ6ICcxMjM0NTY3ODknLFxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBuYW1lOiAnZGFuaWFsJyxcclxuICAgICAgICAgICAgICAgICAgICBmYWNpbGl0eTogJ0JhZG1pbnRvbiBDb3VydCcsXHJcbiAgICAgICAgICAgICAgICAgICAgZGF0ZTogJzI3LzEyLzIzJyxcclxuICAgICAgICAgICAgICAgICAgICB0aW1lOiAnNXBtIC0gN3BtJyxcclxuICAgICAgICAgICAgICAgICAgICBpZDogJzEyMzQ1Njc4OTEwJyxcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgXSkpO1xyXG5cclxuICAgICAgICBjb25zdCByZXMgPSB7XHJcbiAgICAgICAgICAgIHN0YXR1czogZnVuY3Rpb24gKGNvZGUpIHtcclxuICAgICAgICAgICAgICAgIGV4cGVjdChjb2RlKS50by5lcXVhbCg0MDApO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGpzb246IGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICBleHBlY3QoZGF0YS5tZXNzYWdlKS50by5lcXVhbChcclxuICAgICAgICAgICAgICAgICAgICAnVGhlIGNob3NlbiB0aW1lIGZvciB0aGlzIGZhY2lsaXR5IGlzIGFscmVhZHkgYm9va2VkIGJ5IGFub3RoZXIgcGVyc29uLiBQbGVhc2UgY2hvb3NlIGFub3RoZXIgdGltaW5nLidcclxuICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgYXdhaXQgdXBkYXRlQm9va2luZyhyZXEsIHJlcyk7XHJcblxyXG4gICAgICAgIC8vIFZlcmlmeSB0aGF0IGV4cGVjdGF0aW9ucyBhcmUgbWV0XHJcbiAgICAgICAgZnNNb2NrLnZlcmlmeSgpO1xyXG5cclxuICAgICAgICAvLyBSZXN0b3JlIHRoZSBvcmlnaW5hbCBmdW5jdGlvbiBhZnRlciB0aGUgdGVzdFxyXG4gICAgICAgIGZzTW9jay5yZXN0b3JlKCk7XHJcbiAgICB9KTtcclxuXHJcblxyXG4gICAgaXQoJ1Nob3VsZCBub3QgYmUgYWJsZSB0byB1cGRhdGUgYm9va2luZyBkdWUgdG8gaW52YWxpZCBpZCcsIGFzeW5jICgpID0+IHtcclxuICAgICAgICBjb25zdCByZXEgPSB7XHJcblxyXG4gICAgICAgICAgICBib2R5OiB7XHJcbiAgICAgICAgICAgICAgICBmYWNpbGl0eTogXCJCYWRtaW50b24gQ291cnRcIixcclxuICAgICAgICAgICAgICAgIGRhdGU6IFwiMzAvMTEvMjNcIixcclxuICAgICAgICAgICAgICAgIHRpbWU6IFwiOWFtIC0gMTFhbVwiXHJcblxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBwYXJhbXM6IHtcclxuICAgICAgICAgICAgICAgIGlkOiBcIjEyMzQ1NjdcIlxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgLy8gQ3JlYXRlIGEgc3R1YiBmb3IgZnMucmVhZEZpbGUgdG8gcmV0dXJuIHByZWRlZmluZWQgYm9va2luZ3NcclxuICAgICAgICBjb25zdCByZWFkRmlsZVN0dWIgPSBzaW5vbi5zdHViKGZzLCAncmVhZEZpbGUnKTtcclxuICAgICAgICByZWFkRmlsZVN0dWIud2l0aEFyZ3MoYm9va2luZ3NGaWxlUGF0aCwgJ3V0ZjgnKS5yZXNvbHZlcyhKU09OLnN0cmluZ2lmeShbXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIG5hbWU6ICdqb2hubnknLFxyXG4gICAgICAgICAgICAgICAgZmFjaWxpdHk6ICdCYWRtaW50b24gQ291cnQnLFxyXG4gICAgICAgICAgICAgICAgZGF0ZTogJzI1LzEyLzIzJyxcclxuICAgICAgICAgICAgICAgIHRpbWU6ICc1cG0gLSA3cG0nLFxyXG4gICAgICAgICAgICAgICAgaWQ6ICcxMjM0NTY3ODknLFxyXG4gICAgICAgICAgICB9LFxyXG5cclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgbmFtZTogJ2RhbmlhbCcsXHJcbiAgICAgICAgICAgICAgICBmYWNpbGl0eTogJ0JhZG1pbnRvbiBDb3VydCcsXHJcbiAgICAgICAgICAgICAgICBkYXRlOiAnMjcvMTIvMjMnLFxyXG4gICAgICAgICAgICAgICAgdGltZTogJzVwbSAtIDdwbScsXHJcbiAgICAgICAgICAgICAgICBpZDogJzEyMzQ1Njc4OTEwJyxcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICBdKSk7XHJcblxyXG4gICAgICAgIGNvbnN0IHJlcyA9IHtcclxuICAgICAgICAgICAgc3RhdHVzOiBmdW5jdGlvbiAoY29kZSkge1xyXG4gICAgICAgICAgICAgICAgZXhwZWN0KGNvZGUpLnRvLmVxdWFsKDUwMCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAganNvbjogZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgIGV4cGVjdChkYXRhLm1lc3NhZ2UpLnRvLmVxdWFsKCdFcnJvciBvY2N1cnJlZCwgdW5hYmxlIHRvIFVwZGF0ZSEnKTtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICB9O1xyXG4gICAgICAgIGF3YWl0IHVwZGF0ZUJvb2tpbmcocmVxLCByZXMpO1xyXG5cclxuICAgICAgICAvLyBSZXN0b3JlIHRoZSBvcmlnaW5hbCBmdW5jdGlvbiBhZnRlciB0aGUgdGVzdFxyXG4gICAgICAgIHJlYWRGaWxlU3R1Yi5yZXN0b3JlKCk7XHJcblxyXG4gICAgfSk7XHJcbn0pOyJdLCJtYXBwaW5ncyI6IkFBQUEsTUFBTTtFQUFFQSxRQUFRO0VBQUVDO0FBQUcsQ0FBQyxHQUFHQyxPQUFPLENBQUMsT0FBTyxDQUFDO0FBQ3pDLE1BQU07RUFBRUM7QUFBTyxDQUFDLEdBQUdELE9BQU8sQ0FBQyxNQUFNLENBQUM7QUFDbEMsTUFBTUUsS0FBSyxHQUFHRixPQUFPLENBQUMsT0FBTyxDQUFDO0FBQzlCLE1BQU1HLEVBQUUsR0FBR0gsT0FB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","map":{"version":3,"names":["describe","it","require","expect","sinon","fs","promises","viewUserBookings","addBooking","updateBooking","json","bookingsFilePath","orgContent","beforeEach","readFile","JSON","parse","req","params","name","jsonSpy","spy","res","status","code","to","equal","calledOnce","be","true","firstCall","args","an","every","booking","calledWith","message","afterEach","writeFile","stringify","body","facility","date","time","stub","returnsThis","assert","calledWithMatch","match","some","readFileStub","withArgs","resolves","data","restore","id","fsMock","mock","expects","verify"],"sourceRoot":"C:\\Users\\teiji\\TP Year 2-3 Coding Projects\\DevOps Y2\\BookLah\\tests\\","sources":["bookingTests.test.js"],"sourcesContent":["const { describe, it } = require('mocha');\r\nconst { expect } = require('chai');\r\nconst sinon = require('sinon');\r\nconst fs = require('fs').promises;\r\nconst { viewUserBookings, addBooking, updateBooking } = require('../utils/bookingUtil');\r\nconst { json } = require('body-parser');\r\n\r\ndescribe('Testing viewUserBookings Function', () => {\r\n    const bookingsFilePath = 'utils/bookings.json';\r\n    var orgContent = \"\";\r\n\r\n    beforeEach(async () => {\r\n        orgContent = await fs.readFile(bookingsFilePath, 'utf8');\r\n        orgContent = JSON.parse(orgContent);\r\n    });\r\n\r\n    it('Should return bookings for the specified user', async () => {\r\n        const req = {\r\n            params: { name: 'johnny' },\r\n        };\r\n\r\n        // Spy on the res.json method\r\n        const jsonSpy = sinon.spy();\r\n\r\n        const res = {\r\n            status: function (code) {\r\n                expect(code).to.equal(200);\r\n                return this;\r\n            },\r\n            json: jsonSpy,\r\n        };\r\n\r\n        await viewUserBookings(req, res);\r\n\r\n        // Output the value of jsonSpy.firstCall.args[0] to the console for reference\r\n        // console.log('jsonSpy.firstCall.args[]:', jsonSpy.firstCall.args[0]);\r\n\r\n        // Assert that the spy was called with an array\r\n        expect(jsonSpy.calledOnce).to.be.true;\r\n        expect(jsonSpy.firstCall.args[0]).to.be.an('array');\r\n\r\n        // Assert that the spy was called with every element with the correct name\r\n        expect(jsonSpy.firstCall.args[0].every(booking => booking.name === req.params.name)).to.be.true;\r\n\r\n    });\r\n\r\n    it('Should return \"No bookings found for the specified user.\" for users with no bookings', async () => {\r\n        const req = {\r\n            params: { name: 'NonExistentUser' },\r\n        };\r\n\r\n        // Create spy for res.json\r\n\r\n        const jsonSpy = sinon.spy();\r\n\r\n        const res = {\r\n            status: function (code) {\r\n                expect(code).to.equal(404);\r\n                return this;\r\n            },\r\n            json: jsonSpy,\r\n        };\r\n\r\n        await viewUserBookings(req, res);\r\n\r\n        // Assert that json was called with the expected message\r\n        expect(jsonSpy.calledWith({ message: 'No bookings found for the specified user.' })).to.be.true;\r\n\r\n\r\n    });\r\n\r\n});\r\n\r\ndescribe('Testing addBookings Function', () => {\r\n    const bookingsFilePath = 'utils/bookings.json';\r\n    var orgContent = \"\";\r\n\r\n    beforeEach(async () => {\r\n        orgContent = await fs.readFile(bookingsFilePath, 'utf8');\r\n        orgContent = JSON.parse(orgContent);\r\n    });\r\n\r\n    afterEach(async () => {\r\n        await fs.writeFile(bookingsFilePath, JSON.stringify(orgContent), 'utf8');\r\n    });\r\n\r\n    it('Should add a new booking successfully', async () => {\r\n        const req = {\r\n            body: {\r\n                name: 'johnny',\r\n                facility: 'Badminton Court',\r\n                date: '28/11/23',\r\n                time: '9am - 11pm',\r\n            },\r\n        };\r\n\r\n        const res = {\r\n            status: sinon.stub().returnsThis(),  // Creates a stub that returns itself when called. Useful for chaining.\r\n            json: sinon.stub(), //Creates a stub without any specific behavior.\r\n        };\r\n\r\n        await addBooking(req, res);\r\n\r\n        // Assert that status was called with the expected code\r\n        sinon.assert.calledWith(res.status, 201);\r\n\r\n        // Assert that json was called with at least one element in the array that matches the expected properties\r\n        sinon.assert.calledWithMatch(res.json, sinon.match.some(sinon.match({\r\n            name: req.body.name,\r\n            facility: req.body.facility,\r\n            date: req.body.date,\r\n            time: req.body.time,\r\n        })));\r\n\r\n    });\r\n\r\n    it('Should not be able to add booking due to invalid date format or missing date', async () => {\r\n        const req = {\r\n            body: {\r\n                name: \"johnny\",\r\n                facility: 'Badminton Court',\r\n                date: '28/11',\r\n                time: '1pm - 3pm',\r\n            },\r\n        };\r\n\r\n        const jsonSpy = sinon.spy();\r\n\r\n        const res = {\r\n            status: function (code) {\r\n                expect(code).to.equal(400);\r\n                return this;\r\n            },\r\n            json: jsonSpy,\r\n        };\r\n        await addBooking(req, res);\r\n\r\n        expect(jsonSpy.calledWith({ message: 'Invalid date format. Please provide a valid date.' })).to.be.true;\r\n    });\r\n\r\n    it('Should not be able to add booking due to invalid time format or missing time', async () => {\r\n        const req = {\r\n            body: {\r\n                name: \"johnny\",\r\n                facility: 'Badminton Court',\r\n                date: '28/11/23',\r\n\r\n            },\r\n        };\r\n\r\n        const jsonSpy = sinon.spy();\r\n\r\n        const res = {\r\n            status: function (code) {\r\n                expect(code).to.equal(400);\r\n                return this;\r\n            },\r\n            json: jsonSpy,\r\n        };\r\n        await addBooking(req, res);\r\n\r\n        expect(jsonSpy.calledWith({ message: 'Invalid time format. Please provide a valid time range.' })).to.be.true;\r\n    });\r\n\r\n    it('Should not be able to add booking for facility if timing is already booked', async () => {\r\n        const req = {\r\n\r\n            //a request that is not in bookings.JSON, so we need to use stub to test the scenario\r\n            body: {\r\n                name: 'johnny',\r\n                facility: 'Badminton Court',\r\n                date: '25/12/23',\r\n                time: '5pm - 7pm',\r\n            },\r\n        };\r\n\r\n        // Create a stub for fs.readFile to return predefined bookings\r\n        //allows me to control the behavior of fs.readFile during the test, \r\n        //ensuring that it returns specific data I've defined rather than reading from an actual file.\r\n        const readFileStub = sinon.stub(fs, 'readFile');\r\n        readFileStub.withArgs(bookingsFilePath, 'utf8').resolves(JSON.stringify([\r\n            {\r\n                name: 'johnny',\r\n                facility: 'Badminton Court',\r\n                date: '25/12/23',\r\n                time: '5pm - 7pm',\r\n            }\r\n\r\n        ]));\r\n\r\n        const res = {\r\n            status: function (code) {\r\n                expect(code).to.equal(400);\r\n                return this;\r\n            },\r\n            json: function (data) {\r\n                expect(data.message).to.equal('The chosen time for this facility is already booked by another person. Please choose another timing.');\r\n            },\r\n        };\r\n\r\n        await addBooking(req, res);\r\n\r\n        // Restore the original function after the test\r\n        readFileStub.restore();\r\n    });\r\n\r\n});\r\n\r\ndescribe('Testing updateBookings Function', () => {\r\n    const bookingsFilePath = 'utils/bookings.json';\r\n    var orgContent = \"\";\r\n\r\n    beforeEach(async () => {\r\n\r\n        orgContent = await fs.readFile(bookingsFilePath, 'utf8');\r\n        orgContent = JSON.parse(orgContent);\r\n    });\r\n\r\n    afterEach(async () => {\r\n        await fs.writeFile(bookingsFilePath, JSON.stringify(orgContent), 'utf8');\r\n    });\r\n\r\n    it('Should update booking successfully', async () => {\r\n        const req = {\r\n            body: {\r\n                facility: \"Badminton Court\",\r\n                date: \"25/12/23\",\r\n                time: \"7pm - 9pm\",\r\n            },\r\n            params: {\r\n                id: '12345678'\r\n            }\r\n        };\r\n\r\n        // Create a stub for fs.readFile to return predefined bookings\r\n        const readFileStub = sinon.stub(fs, 'readFile');\r\n        readFileStub.withArgs(bookingsFilePath, 'utf8').resolves(JSON.stringify([\r\n            {\r\n                name: 'johnny',\r\n                facility: 'Badminton Court',\r\n                date: '25/12/23',\r\n                time: '5pm - 7pm',\r\n                id: '12345678',\r\n            }\r\n\r\n        ]));\r\n\r\n        const res = {\r\n            status: function (code) {\r\n                expect(code).to.equal(201);\r\n                return this;\r\n            },\r\n            json: function (data) {\r\n                expect(data.message).to.equal('Booking Updated Successfully!');\r\n            },\r\n        };\r\n\r\n        await updateBooking(req, res);\r\n\r\n        // Restore the original function after the test\r\n        readFileStub.restore();\r\n\r\n    });\r\n\r\n    it('Should not be able to update booking due to invalid date format or missing date', async () => {\r\n        const req = {\r\n            body: {\r\n                name: \"johnny\",\r\n                facility: 'Badminton Court',\r\n                time: '1pm - 3pm',\r\n            },\r\n\r\n            params: {\r\n                id: '123456789'\r\n            }\r\n        };\r\n\r\n        // Create a stub for fs.readFile to return predefined bookings\r\n        const readFileStub = sinon.stub(fs, 'readFile');\r\n        readFileStub.withArgs(bookingsFilePath, 'utf8').resolves(JSON.stringify([\r\n            {\r\n                name: 'johnny',\r\n                facility: 'Badminton Court',\r\n                date: '25/12/23',\r\n                time: '5pm - 7pm',\r\n                id: '123456789',\r\n            }\r\n\r\n        ]));\r\n\r\n        const res = {\r\n            status: function (code) {\r\n                expect(code).to.equal(400);\r\n                return this;\r\n            },\r\n            json: function (data) {\r\n                expect(data.message).to.equal('Invalid date format. Please provide a valid date.');\r\n            },\r\n        };\r\n        await updateBooking(req, res);\r\n\r\n        // Restore the original function after the test\r\n        readFileStub.restore();\r\n    });\r\n\r\n    it('Should not be able to update booking due to invalid time format or missing time', async () => {\r\n        const req = {\r\n            body: {\r\n                name: \"johnny\",\r\n                facility: 'Badminton Court',\r\n                date: '28/11/23',\r\n            },\r\n\r\n            params: {\r\n                id: '123456789'\r\n            }\r\n        };\r\n\r\n        // Create a stub for fs.readFile to return predefined bookings\r\n        const readFileStub = sinon.stub(fs, 'readFile');\r\n        readFileStub.withArgs(bookingsFilePath, 'utf8').resolves(JSON.stringify([\r\n            {\r\n                name: 'johnny',\r\n                facility: 'Badminton Court',\r\n                date: '25/12/23',\r\n                time: '5pm - 7pm',\r\n                id: '123456789',\r\n            }\r\n\r\n        ]));\r\n\r\n        const res = {\r\n            status: function (code) {\r\n                expect(code).to.equal(400);\r\n                return this;\r\n            },\r\n            json: function (data) {\r\n                expect(data.message).to.equal('Invalid time format. Please provide a valid time range.');\r\n            },\r\n        };\r\n        await updateBooking(req, res);\r\n\r\n        // Restore the original function after the test\r\n        readFileStub.restore();\r\n\r\n    });\r\n\r\n    it('Should not be able to update booking due to conflict with another booking', async () => {\r\n        const req = {\r\n            body: {\r\n                facility: \"Badminton Court\",\r\n                date: \"27/12/23\",\r\n                time: \"5pm - 7pm\",\r\n            },\r\n            params: {\r\n                id: '123456789'\r\n            }\r\n        };\r\n\r\n        // Create a mock for fs module\r\n        const fsMock = sinon.mock(fs);\r\n\r\n        // Expect readFile to be called with specific arguments and resolve with predefined bookings\r\n        //I expect the readFile function to be called with specific arguments, and when it is called, \r\n        //it should resolve with a predefined array of bookings.\r\n        fsMock.expects('readFile')\r\n            .withArgs(bookingsFilePath, 'utf8')\r\n            .resolves(JSON.stringify([\r\n                {\r\n                    name: 'johnny',\r\n                    facility: 'Badminton Court',\r\n                    date: '25/12/23',\r\n                    time: '5pm - 7pm',\r\n                    id: '123456789',\r\n                },\r\n                {\r\n                    name: 'danial',\r\n                    facility: 'Badminton Court',\r\n                    date: '27/12/23',\r\n                    time: '5pm - 7pm',\r\n                    id: '12345678910',\r\n                }\r\n            ]));\r\n\r\n        const res = {\r\n            status: function (code) {\r\n                expect(code).to.equal(400);\r\n                return this;\r\n            },\r\n            json: function (data) {\r\n                expect(data.message).to.equal(\r\n                    'The chosen time for this facility is already booked by another person. Please choose another timing.'\r\n                );\r\n            },\r\n        };\r\n\r\n        await updateBooking(req, res);\r\n\r\n        // Verify that expectations are met\r\n        fsMock.verify();\r\n\r\n        // Restore the original function after the test\r\n        fsMock.restore();\r\n    });\r\n\r\n\r\n    it('Should not be able to update booking due to invalid id', async () => {\r\n        const req = {\r\n\r\n            body: {\r\n                facility: \"Badminton Court\",\r\n                date: \"30/11/23\",\r\n                time: \"9am - 11am\"\r\n\r\n            },\r\n            params: {\r\n                id: \"1234567\"\r\n            }\r\n        };\r\n\r\n        // Create a stub for fs.readFile to return predefined bookings\r\n        const readFileStub = sinon.stub(fs, 'readFile');\r\n        readFileStub.withArgs(bookingsFilePath, 'utf8').resolves(JSON.stringify([\r\n            {\r\n                name: 'johnny',\r\n                facility: 'Badminton Court',\r\n                date: '25/12/23',\r\n                time: '5pm - 7pm',\r\n                id: '123456789',\r\n            },\r\n\r\n            {\r\n                name: 'danial',\r\n                facility: 'Badminton Court',\r\n                date: '27/12/23',\r\n                time: '5pm - 7pm',\r\n                id: '12345678910',\r\n            }\r\n\r\n        ]));\r\n\r\n        const res = {\r\n            status: function (code) {\r\n                expect(code).to.equal(500);\r\n                return this;\r\n            },\r\n            json: function (data) {\r\n                expect(data.message).to.equal('Error occurred, unable to Update!');\r\n            },\r\n        };\r\n        await updateBooking(req, res);\r\n\r\n        // Restore the original function after the test\r\n        readFileStub.restore();\r\n\r\n    });\r\n});"],"mappings":"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"}},"mtime":1700999288331},"{\"assumptions\":{},\"sourceRoot\":\"C:\\\\Users\\\\teiji\\\\TP Year 2-3 Coding Projects\\\\DevOps Y2\\\\BookLah\\\\utils\\\\\",\"caller\":{\"name\":\"@babel/register\"},\"cwd\":\"C:\\\\Users\\\\teiji\\\\TP Year 2-3 Coding Projects\\\\DevOps Y2\\\\BookLah\",\"filename\":\"C:\\\\Users\\\\teiji\\\\TP Year 2-3 Coding Projects\\\\DevOps Y2\\\\BookLah\\\\utils\\\\bookingUtil.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"C:\\\\Users\\\\teiji\\\\TP Year 2-3 Coding Projects\\\\DevOps Y2\\\\BookLah\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.23.3:development":{"value":{"code":"const fs = require('fs').promises;\nconst {\n  Booking\n} = require('../models/Booking');\nconst {\n  readJSON,\n  writeJSON\n} = require('./userUtil');\n\n// Helper function to validate date format\nfunction isValidDateFormat(date) {\n  // Regular expression for \"Day/month/year\" format\n  const dateFormatRegex = /^\\d{1,2}\\/\\d{1,2}\\/\\d{2}$/;\n  //check if the provided date string matches the pattern defined by the regular expression dateFormatRegex.\n  return dateFormatRegex.test(date);\n}\n\n// Helper function to validate time format\nfunction isValidTimeFormat(time) {\n  // You can use a more sophisticated time validation logic if needed\n  // For simplicity, this example checks if the time has a valid format\n  return typeof time === 'string' && time.trim() !== '';\n}\nasync function viewUserBookings(req, res) {\n  const requestedUsername = req.params.name; // Getting name from the route parameter\n\n  try {\n    const allBookings = await readJSON('utils/bookings.json');\n\n    // Filter bookings based on the requested username\n    const userBookings = allBookings.filter(booking => booking.name === requestedUsername);\n    if (userBookings.length === 0) {\n      // If no bookings were found for the specified username\n      return res.status(404).json({\n        message: \"No bookings found for the specified user.\"\n      });\n    }\n    return res.status(200).json(userBookings);\n  } catch (error) {\n    return res.status(500).json({\n      message: error.message\n    });\n  }\n}\nasync function addBooking(req, res) {\n  try {\n    const allBookings = await readJSON('utils/bookings.json');\n    const name = req.body.name;\n    const facility = req.body.facility;\n    const date = req.body.date;\n    const time = req.body.time;\n\n    // Validate date format\n    if (!isValidDateFormat(date)) {\n      return res.status(400).json({\n        message: 'Invalid date format. Please provide a valid date.'\n      });\n    }\n\n    // Validate time format\n    if (!isValidTimeFormat(time)) {\n      return res.status(400).json({\n        message: 'Invalid time format. Please provide a valid time range.'\n      });\n    }\n\n    // Check if the proposed booking already exists in the JSON file\n    const bookingExists = allBookings.some(booking => booking.facility === facility && booking.date === date && booking.time === time);\n    if (bookingExists) {\n      return res.status(400).json({\n        message: 'The chosen time for this facility is already booked by another person. Please choose another timing.'\n      });\n    }\n    const newBooking = new Booking(name, facility, date, time);\n    const updatedBookings = await writeJSON(newBooking, 'utils/bookings.json');\n    return res.status(201).json(updatedBookings);\n  } catch (error) {\n    return res.status(500).json({\n      message: error.message\n    });\n  }\n}\nasync function updateBooking(req, res) {\n  try {\n    const id = req.params.id;\n    const facility = req.body.facility;\n    const date = req.body.date;\n    const time = req.body.time;\n\n    // Validate date format\n    if (!isValidDateFormat(date)) {\n      return res.status(400).json({\n        message: 'Invalid date format. Please provide a valid date.'\n      });\n    }\n\n    // Validate time format\n    if (!isValidTimeFormat(time)) {\n      return res.status(400).json({\n        message: 'Invalid time format. Please provide a valid time range.'\n      });\n    }\n    const allBookings = await readJSON('utils/bookings.json');\n    var modified = false;\n\n    // Check if the proposed changes are already booked\n    const isBookingConflict = allBookings.some(booking => booking.id !== id &&\n    // Exclude the current booking being updated\n    booking.facility === facility && booking.date === date && booking.time === time);\n    if (isBookingConflict) {\n      return res.status(400).json({\n        message: 'The chosen time for this facility is already booked by another person. Please choose another timing.'\n      });\n    }\n    for (var i = 0; i < allBookings.length; i++) {\n      var currentBooking = allBookings[i];\n      if (currentBooking.id == id) {\n        allBookings[i].facility = facility;\n        allBookings[i].date = date;\n        allBookings[i].time = time;\n        modified = true;\n      }\n    }\n    if (modified) {\n      await fs.writeFile('utils/bookings.json', JSON.stringify(allBookings), 'utf8');\n      return res.status(201).json({\n        message: 'Booking Updated Successfully!'\n      });\n    } else {\n      return res.status(500).json({\n        message: 'Error occurred, unable to Update!'\n      });\n    }\n  } catch (error) {\n    return res.status(500).json({\n      message: error.message\n    });\n  }\n}\nmodule.exports = {\n  viewUserBookings,\n  addBooking,\n  updateBooking\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJmcyIsInJlcXVpcmUiLCJwcm9taXNlcyIsIkJvb2tpbmciLCJyZWFkSlNPTiIsIndyaXRlSlNPTiIsImlzVmFsaWREYXRlRm9ybWF0IiwiZGF0ZSIsImRhdGVGb3JtYXRSZWdleCIsInRlc3QiLCJpc1ZhbGlkVGltZUZvcm1hdCIsInRpbWUiLCJ0cmltIiwidmlld1VzZXJCb29raW5ncyIsInJlcSIsInJlcyIsInJlcXVlc3RlZFVzZXJuYW1lIiwicGFyYW1zIiwibmFtZSIsImFsbEJvb2tpbmdzIiwidXNlckJvb2tpbmdzIiwiZmlsdGVyIiwiYm9va2luZyIsImxlbmd0aCIsInN0YXR1cyIsImpzb24iLCJtZXNzYWdlIiwiZXJyb3IiLCJhZGRCb29raW5nIiwiYm9keSIsImZhY2lsaXR5IiwiYm9va2luZ0V4aXN0cyIsInNvbWUiLCJuZXdCb29raW5nIiwidXBkYXRlZEJvb2tpbmdzIiwidXBkYXRlQm9va2luZyIsImlkIiwibW9kaWZpZWQiLCJpc0Jvb2tpbmdDb25mbGljdCIsImkiLCJjdXJyZW50Qm9va2luZyIsIndyaXRlRmlsZSIsIkpTT04iLCJzdHJpbmdpZnkiLCJtb2R1bGUiLCJleHBvcnRzIl0sInNvdXJjZVJvb3QiOiJDOlxcVXNlcnNcXHRlaWppXFxUUCBZZWFyIDItMyBDb2RpbmcgUHJvamVjdHNcXERldk9wcyBZMlxcQm9va0xhaFxcdXRpbHNcXCIsInNvdXJjZXMiOlsiYm9va2luZ1V0aWwuanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgZnMgPSByZXF1aXJlKCdmcycpLnByb21pc2VzO1xyXG5jb25zdCB7IEJvb2tpbmcgfSA9IHJlcXVpcmUoJy4uL21vZGVscy9Cb29raW5nJyk7XHJcbmNvbnN0IHsgcmVhZEpTT04sIHdyaXRlSlNPTiB9ID0gcmVxdWlyZSgnLi91c2VyVXRpbCcpXHJcblxyXG4vLyBIZWxwZXIgZnVuY3Rpb24gdG8gdmFsaWRhdGUgZGF0ZSBmb3JtYXRcclxuZnVuY3Rpb24gaXNWYWxpZERhdGVGb3JtYXQoZGF0ZSkge1xyXG5cclxuICAgIC8vIFJlZ3VsYXIgZXhwcmVzc2lvbiBmb3IgXCJEYXkvbW9udGgveWVhclwiIGZvcm1hdFxyXG4gICAgY29uc3QgZGF0ZUZvcm1hdFJlZ2V4ID0gL15cXGR7MSwyfVxcL1xcZHsxLDJ9XFwvXFxkezJ9JC87XHJcbiAgICAvL2NoZWNrIGlmIHRoZSBwcm92aWRlZCBkYXRlIHN0cmluZyBtYXRjaGVzIHRoZSBwYXR0ZXJuIGRlZmluZWQgYnkgdGhlIHJlZ3VsYXIgZXhwcmVzc2lvbiBkYXRlRm9ybWF0UmVnZXguXHJcbiAgICByZXR1cm4gZGF0ZUZvcm1hdFJlZ2V4LnRlc3QoZGF0ZSk7XHJcbn1cclxuXHJcbi8vIEhlbHBlciBmdW5jdGlvbiB0byB2YWxpZGF0ZSB0aW1lIGZvcm1hdFxyXG5mdW5jdGlvbiBpc1ZhbGlkVGltZUZvcm1hdCh0aW1lKSB7XHJcbiAgICAvLyBZb3UgY2FuIHVzZSBhIG1vcmUgc29waGlzdGljYXRlZCB0aW1lIHZhbGlkYXRpb24gbG9naWMgaWYgbmVlZGVkXHJcbiAgICAvLyBGb3Igc2ltcGxpY2l0eSwgdGhpcyBleGFtcGxlIGNoZWNrcyBpZiB0aGUgdGltZSBoYXMgYSB2YWxpZCBmb3JtYXRcclxuICAgIHJldHVybiB0eXBlb2YgdGltZSA9PT0gJ3N0cmluZycgJiYgdGltZS50cmltKCkgIT09ICcnO1xyXG59XHJcblxyXG5hc3luYyBmdW5jdGlvbiB2aWV3VXNlckJvb2tpbmdzKHJlcSwgcmVzKSB7XHJcblxyXG4gICAgY29uc3QgcmVxdWVzdGVkVXNlcm5hbWUgPSByZXEucGFyYW1zLm5hbWU7IC8vIEdldHRpbmcgbmFtZSBmcm9tIHRoZSByb3V0ZSBwYXJhbWV0ZXJcclxuXHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGFsbEJvb2tpbmdzID0gYXdhaXQgcmVhZEpTT04oJ3V0aWxzL2Jvb2tpbmdzLmpzb24nKTtcclxuXHJcbiAgICAgICAgLy8gRmlsdGVyIGJvb2tpbmdzIGJhc2VkIG9uIHRoZSByZXF1ZXN0ZWQgdXNlcm5hbWVcclxuICAgICAgICBjb25zdCB1c2VyQm9va2luZ3MgPSBhbGxCb29raW5ncy5maWx0ZXIoYm9va2luZyA9PiBib29raW5nLm5hbWUgPT09IHJlcXVlc3RlZFVzZXJuYW1lKTtcclxuXHJcbiAgICAgICAgaWYgKHVzZXJCb29raW5ncy5sZW5ndGggPT09IDApIHtcclxuICAgICAgICAgICAgLy8gSWYgbm8gYm9va2luZ3Mgd2VyZSBmb3VuZCBmb3IgdGhlIHNwZWNpZmllZCB1c2VybmFtZVxyXG4gICAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDQpLmpzb24oeyBtZXNzYWdlOiBcIk5vIGJvb2tpbmdzIGZvdW5kIGZvciB0aGUgc3BlY2lmaWVkIHVzZXIuXCIgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cygyMDApLmpzb24odXNlckJvb2tpbmdzKTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgbWVzc2FnZTogZXJyb3IubWVzc2FnZSB9KTtcclxuICAgIH1cclxufVxyXG5cclxuYXN5bmMgZnVuY3Rpb24gYWRkQm9va2luZyhyZXEsIHJlcykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBhbGxCb29raW5ncyA9IGF3YWl0IHJlYWRKU09OKCd1dGlscy9ib29raW5ncy5qc29uJyk7XHJcblxyXG4gICAgICAgIGNvbnN0IG5hbWUgPSByZXEuYm9keS5uYW1lO1xyXG4gICAgICAgIGNvbnN0IGZhY2lsaXR5ID0gcmVxLmJvZHkuZmFjaWxpdHk7XHJcbiAgICAgICAgY29uc3QgZGF0ZSA9IHJlcS5ib2R5LmRhdGU7XHJcbiAgICAgICAgY29uc3QgdGltZSA9IHJlcS5ib2R5LnRpbWU7XHJcblxyXG4gICAgICAgIC8vIFZhbGlkYXRlIGRhdGUgZm9ybWF0XHJcbiAgICAgICAgaWYgKCFpc1ZhbGlkRGF0ZUZvcm1hdChkYXRlKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oeyBtZXNzYWdlOiAnSW52YWxpZCBkYXRlIGZvcm1hdC4gUGxlYXNlIHByb3ZpZGUgYSB2YWxpZCBkYXRlLicgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBWYWxpZGF0ZSB0aW1lIGZvcm1hdFxyXG4gICAgICAgIGlmICghaXNWYWxpZFRpbWVGb3JtYXQodGltZSkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHsgbWVzc2FnZTogJ0ludmFsaWQgdGltZSBmb3JtYXQuIFBsZWFzZSBwcm92aWRlIGEgdmFsaWQgdGltZSByYW5nZS4nIH0pO1xyXG4gICAgICAgIH1cclxuXHJcblxyXG4gICAgICAgIC8vIENoZWNrIGlmIHRoZSBwcm9wb3NlZCBib29raW5nIGFscmVhZHkgZXhpc3RzIGluIHRoZSBKU09OIGZpbGVcclxuICAgICAgICBjb25zdCBib29raW5nRXhpc3RzID0gYWxsQm9va2luZ3Muc29tZShcclxuICAgICAgICAgICAgKGJvb2tpbmcpID0+XHJcbiAgICAgICAgICAgICAgICBib29raW5nLmZhY2lsaXR5ID09PSBmYWNpbGl0eSAmJlxyXG4gICAgICAgICAgICAgICAgYm9va2luZy5kYXRlID09PSBkYXRlICYmXHJcbiAgICAgICAgICAgICAgICBib29raW5nLnRpbWUgPT09IHRpbWVcclxuICAgICAgICApO1xyXG5cclxuICAgICAgICBpZiAoYm9va2luZ0V4aXN0cykge1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oe1xyXG4gICAgICAgICAgICAgICAgbWVzc2FnZTpcclxuICAgICAgICAgICAgICAgICAgICAnVGhlIGNob3NlbiB0aW1lIGZvciB0aGlzIGZhY2lsaXR5IGlzIGFscmVhZHkgYm9va2VkIGJ5IGFub3RoZXIgcGVyc29uLiBQbGVhc2UgY2hvb3NlIGFub3RoZXIgdGltaW5nLicsXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgbmV3Qm9va2luZyA9IG5ldyBCb29raW5nKG5hbWUsIGZhY2lsaXR5LCBkYXRlLCB0aW1lKTtcclxuXHJcbiAgICAgICAgY29uc3QgdXBkYXRlZEJvb2tpbmdzID0gYXdhaXQgd3JpdGVKU09OKG5ld0Jvb2tpbmcsICd1dGlscy9ib29raW5ncy5qc29uJyk7XHJcblxyXG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDIwMSkuanNvbih1cGRhdGVkQm9va2luZ3MpO1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg1MDApLmpzb24oeyBtZXNzYWdlOiBlcnJvci5tZXNzYWdlIH0pO1xyXG4gICAgfVxyXG59XHJcblxyXG5hc3luYyBmdW5jdGlvbiB1cGRhdGVCb29raW5nKHJlcSwgcmVzKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGlkID0gcmVxLnBhcmFtcy5pZDtcclxuICAgICAgICBjb25zdCBmYWNpbGl0eSA9IHJlcS5ib2R5LmZhY2lsaXR5O1xyXG4gICAgICAgIGNvbnN0IGRhdGUgPSByZXEuYm9keS5kYXRlO1xyXG4gICAgICAgIGNvbnN0IHRpbWUgPSByZXEuYm9keS50aW1lO1xyXG5cclxuICAgICAgICAgLy8gVmFsaWRhdGUgZGF0ZSBmb3JtYXRcclxuICAgICAgICAgaWYgKCFpc1ZhbGlkRGF0ZUZvcm1hdChkYXRlKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oeyBtZXNzYWdlOiAnSW52YWxpZCBkYXRlIGZvcm1hdC4gUGxlYXNlIHByb3ZpZGUgYSB2YWxpZCBkYXRlLicgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBWYWxpZGF0ZSB0aW1lIGZvcm1hdFxyXG4gICAgICAgIGlmICghaXNWYWxpZFRpbWVGb3JtYXQodGltZSkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHsgbWVzc2FnZTogJ0ludmFsaWQgdGltZSBmb3JtYXQuIFBsZWFzZSBwcm92aWRlIGEgdmFsaWQgdGltZSByYW5nZS4nIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICBjb25zdCBhbGxCb29raW5ncyA9IGF3YWl0IHJlYWRKU09OKCd1dGlscy9ib29raW5ncy5qc29uJyk7XHJcbiAgICAgICAgdmFyIG1vZGlmaWVkID0gZmFsc2U7XHJcblxyXG4gICAgICAgIC8vIENoZWNrIGlmIHRoZSBwcm9wb3NlZCBjaGFuZ2VzIGFyZSBhbHJlYWR5IGJvb2tlZFxyXG4gICAgICAgIGNvbnN0IGlzQm9va2luZ0NvbmZsaWN0ID0gYWxsQm9va2luZ3Muc29tZShcclxuICAgICAgICAgICAgKGJvb2tpbmcpID0+XHJcbiAgICAgICAgICAgICAgICBib29raW5nLmlkICE9PSBpZCAmJiAvLyBFeGNsdWRlIHRoZSBjdXJyZW50IGJvb2tpbmcgYmVpbmcgdXBkYXRlZFxyXG4gICAgICAgICAgICAgICAgYm9va2luZy5mYWNpbGl0eSA9PT0gZmFjaWxpdHkgJiZcclxuICAgICAgICAgICAgICAgIGJvb2tpbmcuZGF0ZSA9PT0gZGF0ZSAmJlxyXG4gICAgICAgICAgICAgICAgYm9va2luZy50aW1lID09PSB0aW1lXHJcbiAgICAgICAgKTtcclxuXHJcbiAgICAgICAgaWYgKGlzQm9va2luZ0NvbmZsaWN0KSB7XHJcbiAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7XHJcbiAgICAgICAgICAgICAgICBtZXNzYWdlOlxyXG4gICAgICAgICAgICAgICAgICAgICdUaGUgY2hvc2VuIHRpbWUgZm9yIHRoaXMgZmFjaWxpdHkgaXMgYWxyZWFkeSBib29rZWQgYnkgYW5vdGhlciBwZXJzb24uIFBsZWFzZSBjaG9vc2UgYW5vdGhlciB0aW1pbmcuJyxcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFsbEJvb2tpbmdzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciBjdXJyZW50Qm9va2luZyA9IGFsbEJvb2tpbmdzW2ldO1xyXG4gICAgICAgICAgICBpZiAoY3VycmVudEJvb2tpbmcuaWQgPT0gaWQpIHtcclxuICAgICAgICAgICAgICAgIGFsbEJvb2tpbmdzW2ldLmZhY2lsaXR5ID0gZmFjaWxpdHk7XHJcbiAgICAgICAgICAgICAgICBhbGxCb29raW5nc1tpXS5kYXRlID0gZGF0ZTtcclxuICAgICAgICAgICAgICAgIGFsbEJvb2tpbmdzW2ldLnRpbWUgPSB0aW1lO1xyXG4gICAgICAgICAgICAgICAgbW9kaWZpZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAobW9kaWZpZWQpIHtcclxuICAgICAgICAgICAgYXdhaXQgZnMud3JpdGVGaWxlKCd1dGlscy9ib29raW5ncy5qc29uJywgSlNPTi5zdHJpbmdpZnkoYWxsQm9va2luZ3MpLCAndXRmOCcpO1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cygyMDEpLmpzb24oeyBtZXNzYWdlOiAnQm9va2luZyBVcGRhdGVkIFN1Y2Nlc3NmdWxseSEnIH0pO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDUwMCkuanNvbih7IG1lc3NhZ2U6ICdFcnJvciBvY2N1cnJlZCwgdW5hYmxlIHRvIFVwZGF0ZSEnIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgbWVzc2FnZTogZXJyb3IubWVzc2FnZSB9KTtcclxuICAgIH1cclxufVxyXG5cclxuXHJcbm1vZHVsZS5leHBvcnRzID0geyB2aWV3VXNlckJvb2tpbmdzLCBhZGRCb29raW5nLCB1cGRhdGVCb29raW5nIH1cclxuIl0sIm1hcHBpbmdzIjoiQUFBQSxNQUFNQSxFQUFFLEdBQUdDLE9BQU8sQ0FBQyxJQUFJLENB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","map":{"version":3,"names":["fs","require","promises","Booking","readJSON","writeJSON","isValidDateFormat","date","dateFormatRegex","test","isValidTimeFormat","time","trim","viewUserBookings","req","res","requestedUsername","params","name","allBookings","userBookings","filter","booking","length","status","json","message","error","addBooking","body","facility","bookingExists","some","newBooking","updatedBookings","updateBooking","id","modified","isBookingConflict","i","currentBooking","writeFile","JSON","stringify","module","exports"],"sourceRoot":"C:\\Users\\teiji\\TP Year 2-3 Coding Projects\\DevOps Y2\\BookLah\\utils\\","sources":["bookingUtil.js"],"sourcesContent":["const fs = require('fs').promises;\r\nconst { Booking } = require('../models/Booking');\r\nconst { readJSON, writeJSON } = require('./userUtil')\r\n\r\n// Helper function to validate date format\r\nfunction isValidDateFormat(date) {\r\n\r\n    // Regular expression for \"Day/month/year\" format\r\n    const dateFormatRegex = /^\\d{1,2}\\/\\d{1,2}\\/\\d{2}$/;\r\n    //check if the provided date string matches the pattern defined by the regular expression dateFormatRegex.\r\n    return dateFormatRegex.test(date);\r\n}\r\n\r\n// Helper function to validate time format\r\nfunction isValidTimeFormat(time) {\r\n    // You can use a more sophisticated time validation logic if needed\r\n    // For simplicity, this example checks if the time has a valid format\r\n    return typeof time === 'string' && time.trim() !== '';\r\n}\r\n\r\nasync function viewUserBookings(req, res) {\r\n\r\n    const requestedUsername = req.params.name; // Getting name from the route parameter\r\n\r\n    try {\r\n        const allBookings = await readJSON('utils/bookings.json');\r\n\r\n        // Filter bookings based on the requested username\r\n        const userBookings = allBookings.filter(booking => booking.name === requestedUsername);\r\n\r\n        if (userBookings.length === 0) {\r\n            // If no bookings were found for the specified username\r\n            return res.status(404).json({ message: \"No bookings found for the specified user.\" });\r\n        }\r\n\r\n        return res.status(200).json(userBookings);\r\n    } catch (error) {\r\n        return res.status(500).json({ message: error.message });\r\n    }\r\n}\r\n\r\nasync function addBooking(req, res) {\r\n    try {\r\n        const allBookings = await readJSON('utils/bookings.json');\r\n\r\n        const name = req.body.name;\r\n        const facility = req.body.facility;\r\n        const date = req.body.date;\r\n        const time = req.body.time;\r\n\r\n        // Validate date format\r\n        if (!isValidDateFormat(date)) {\r\n            return res.status(400).json({ message: 'Invalid date format. Please provide a valid date.' });\r\n        }\r\n\r\n        // Validate time format\r\n        if (!isValidTimeFormat(time)) {\r\n            return res.status(400).json({ message: 'Invalid time format. Please provide a valid time range.' });\r\n        }\r\n\r\n\r\n        // Check if the proposed booking already exists in the JSON file\r\n        const bookingExists = allBookings.some(\r\n            (booking) =>\r\n                booking.facility === facility &&\r\n                booking.date === date &&\r\n                booking.time === time\r\n        );\r\n\r\n        if (bookingExists) {\r\n            return res.status(400).json({\r\n                message:\r\n                    'The chosen time for this facility is already booked by another person. Please choose another timing.',\r\n            });\r\n        }\r\n\r\n        const newBooking = new Booking(name, facility, date, time);\r\n\r\n        const updatedBookings = await writeJSON(newBooking, 'utils/bookings.json');\r\n\r\n        return res.status(201).json(updatedBookings);\r\n    } catch (error) {\r\n        return res.status(500).json({ message: error.message });\r\n    }\r\n}\r\n\r\nasync function updateBooking(req, res) {\r\n    try {\r\n        const id = req.params.id;\r\n        const facility = req.body.facility;\r\n        const date = req.body.date;\r\n        const time = req.body.time;\r\n\r\n         // Validate date format\r\n         if (!isValidDateFormat(date)) {\r\n            return res.status(400).json({ message: 'Invalid date format. Please provide a valid date.' });\r\n        }\r\n\r\n        // Validate time format\r\n        if (!isValidTimeFormat(time)) {\r\n            return res.status(400).json({ message: 'Invalid time format. Please provide a valid time range.' });\r\n        }\r\n        \r\n        const allBookings = await readJSON('utils/bookings.json');\r\n        var modified = false;\r\n\r\n        // Check if the proposed changes are already booked\r\n        const isBookingConflict = allBookings.some(\r\n            (booking) =>\r\n                booking.id !== id && // Exclude the current booking being updated\r\n                booking.facility === facility &&\r\n                booking.date === date &&\r\n                booking.time === time\r\n        );\r\n\r\n        if (isBookingConflict) {\r\n            return res.status(400).json({\r\n                message:\r\n                    'The chosen time for this facility is already booked by another person. Please choose another timing.',\r\n            });\r\n        }\r\n\r\n        for (var i = 0; i < allBookings.length; i++) {\r\n            var currentBooking = allBookings[i];\r\n            if (currentBooking.id == id) {\r\n                allBookings[i].facility = facility;\r\n                allBookings[i].date = date;\r\n                allBookings[i].time = time;\r\n                modified = true;\r\n            }\r\n        }\r\n\r\n        if (modified) {\r\n            await fs.writeFile('utils/bookings.json', JSON.stringify(allBookings), 'utf8');\r\n            return res.status(201).json({ message: 'Booking Updated Successfully!' });\r\n        } else {\r\n            return res.status(500).json({ message: 'Error occurred, unable to Update!' });\r\n        }\r\n    } catch (error) {\r\n        return res.status(500).json({ message: error.message });\r\n    }\r\n}\r\n\r\n\r\nmodule.exports = { viewUserBookings, addBooking, updateBooking }\r\n"],"mappings":"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"}},"mtime":1700999288334},"{\"assumptions\":{},\"sourceRoot\":\"C:\\\\Users\\\\teiji\\\\TP Year 2-3 Coding Projects\\\\DevOps Y2\\\\BookLah\\\\models\\\\\",\"caller\":{\"name\":\"@babel/register\"},\"cwd\":\"C:\\\\Users\\\\teiji\\\\TP Year 2-3 Coding Projects\\\\DevOps Y2\\\\BookLah\",\"filename\":\"C:\\\\Users\\\\teiji\\\\TP Year 2-3 Coding Projects\\\\DevOps Y2\\\\BookLah\\\\models\\\\Booking.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"C:\\\\Users\\\\teiji\\\\TP Year 2-3 Coding Projects\\\\DevOps Y2\\\\BookLah\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.23.3:development":{"value":{"code":"class Booking {\n  constructor(name, facility, date, time) {\n    this.name = name;\n    this.facility = facility;\n    this.date = date;\n    this.time = time;\n    const timestamp = new Date().getTime();\n    const random = Math.floor(Math.random() * 1000);\n    this.id = timestamp + \"\" + random.toString().padStart(3, '0');\n  }\n}\nmodule.exports = {\n  Booking\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJCb29raW5nIiwiY29uc3RydWN0b3IiLCJuYW1lIiwiZmFjaWxpdHkiLCJkYXRlIiwidGltZSIsInRpbWVzdGFtcCIsIkRhdGUiLCJnZXRUaW1lIiwicmFuZG9tIiwiTWF0aCIsImZsb29yIiwiaWQiLCJ0b1N0cmluZyIsInBhZFN0YXJ0IiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiQzpcXFVzZXJzXFx0ZWlqaVxcVFAgWWVhciAyLTMgQ29kaW5nIFByb2plY3RzXFxEZXZPcHMgWTJcXEJvb2tMYWhcXG1vZGVsc1xcIiwic291cmNlcyI6WyJCb29raW5nLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNsYXNzIEJvb2tpbmcge1xyXG4gICAgY29uc3RydWN0b3IobmFtZSwgZmFjaWxpdHksIGRhdGUsIHRpbWUpIHtcclxuICAgICAgICB0aGlzLm5hbWUgPSBuYW1lO1xyXG4gICAgICAgIHRoaXMuZmFjaWxpdHkgPSBmYWNpbGl0eTtcclxuICAgICAgICB0aGlzLmRhdGUgPSBkYXRlO1xyXG4gICAgICAgIHRoaXMudGltZSA9IHRpbWU7XHJcblxyXG4gICAgICAgIGNvbnN0IHRpbWVzdGFtcCA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpO1xyXG4gICAgICAgIGNvbnN0IHJhbmRvbSA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwMDApO1xyXG4gICAgICAgIHRoaXMuaWQgPSB0aW1lc3RhbXAgKyBcIlwiICsgcmFuZG9tLnRvU3RyaW5nKCkucGFkU3RhcnQoMywgJzAnKTtcclxuICAgIH1cclxufVxyXG5cclxubW9kdWxlLmV4cG9ydHMgPSB7Qm9va2luZ307Il0sIm1hcHBpbmdzIjoiQUFBQSxNQUFNQSxPQUFPLENBQUM7RUFDVkMsV0FBV0EsQ0FBQ0MsSUFBSSxFQUFFQyxRQUFRLEVBQUVDLElBQUksRUFBRUMsSUFBSSxFQUFFO0lBQ3BDLElBQUksQ0FBQ0gsSUFBSSxHQUFHQSxJQUFJO0lBQ2hCLElBQUksQ0FBQ0MsUUFBUSxHQUFHQSxRQUFRO0lBQ3hCLElBQUksQ0FBQ0MsSUFBSSxHQUFHQSxJQUFJO0lBQ2hCLElBQUksQ0FBQ0MsSUFBSSxHQUFHQSxJQUFJO0lBRWhCLE1BQU1DLFNBQVMsR0FBRyxJQUFJQyxJQUFJLENBQUMsQ0FBQyxDQUFDQyxPQUFPLENBQUMsQ0FBQztJQUN0QyxNQUFNQyxNQUFNLEdBQUdDLElBQUksQ0FBQ0MsS0FBSyxDQUFDRCxJQUFJLENBQUNELE1BQU0sQ0FBQyxDQUFDLEdBQUcsSUFBSSxDQUFDO0lBQy9DLElBQUksQ0FBQ0csRUFBRSxHQUFHTixTQUFTLEdBQUcsRUFBRSxHQUFHRyxNQUFNLENBQUNJLFFBQVEsQ0FBQyxDQUFDLENBQUNDLFFBQVEsQ0FBQyxDQUFDLEVBQUUsR0FBRyxDQUFDO0VBQ2pFO0FBQ0o7QUFFQUMsTUFBTSxDQUFDQyxPQUFPLEdBQUc7RUFBQ2hCO0FBQU8sQ0FBQyJ9","map":{"version":3,"names":["Booking","constructor","name","facility","date","time","timestamp","Date","getTime","random","Math","floor","id","toString","padStart","module","exports"],"sourceRoot":"C:\\Users\\teiji\\TP Year 2-3 Coding Projects\\DevOps Y2\\BookLah\\models\\","sources":["Booking.js"],"sourcesContent":["class Booking {\r\n    constructor(name, facility, date, time) {\r\n        this.name = name;\r\n        this.facility = facility;\r\n        this.date = date;\r\n        this.time = time;\r\n\r\n        const timestamp = new Date().getTime();\r\n        const random = Math.floor(Math.random() * 1000);\r\n        this.id = timestamp + \"\" + random.toString().padStart(3, '0');\r\n    }\r\n}\r\n\r\nmodule.exports = {Booking};"],"mappings":"AAAA,MAAMA,OAAO,CAAC;EACVC,WAAWA,CAACC,IAAI,EAAEC,QAAQ,EAAEC,IAAI,EAAEC,IAAI,EAAE;IACpC,IAAI,CAACH,IAAI,GAAGA,IAAI;IAChB,IAAI,CAACC,QAAQ,GAAGA,QAAQ;IACxB,IAAI,CAACC,IAAI,GAAGA,IAAI;IAChB,IAAI,CAACC,IAAI,GAAGA,IAAI;IAEhB,MAAMC,SAAS,GAAG,IAAIC,IAAI,CAAC,CAAC,CAACC,OAAO,CAAC,CAAC;IACtC,MAAMC,MAAM,GAAGC,IAAI,CAACC,KAAK,CAACD,IAAI,CAACD,MAAM,CAAC,CAAC,GAAG,IAAI,CAAC;IAC/C,IAAI,CAACG,EAAE,GAAGN,SAAS,GAAG,EAAE,GAAGG,MAAM,CAACI,QAAQ,CAAC,CAAC,CAACC,QAAQ,CAAC,CAAC,EAAE,GAAG,CAAC;EACjE;AACJ;AAEAC,MAAM,CAACC,OAAO,GAAG;EAAChB;AAAO,CAAC"}},"mtime":1700907095744},"{\"assumptions\":{},\"sourceRoot\":\"C:\\\\Users\\\\teiji\\\\TP Year 2-3 Coding Projects\\\\DevOps Y2\\\\BookLah\\\\utils\\\\\",\"caller\":{\"name\":\"@babel/register\"},\"cwd\":\"C:\\\\Users\\\\teiji\\\\TP Year 2-3 Coding Projects\\\\DevOps Y2\\\\BookLah\",\"filename\":\"C:\\\\Users\\\\teiji\\\\TP Year 2-3 Coding Projects\\\\DevOps Y2\\\\BookLah\\\\utils\\\\userUtil.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"C:\\\\Users\\\\teiji\\\\TP Year 2-3 Coding Projects\\\\DevOps Y2\\\\BookLah\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.23.3:development":{"value":{"code":"const {\n  User\n} = require('../models/User');\nconst fs = require('fs').promises;\nasync function readJSON(filename) {\n  try {\n    const data = await fs.readFile(filename, 'utf8');\n    return JSON.parse(data);\n  } catch (err) {\n    console.error(err);\n    throw err;\n  }\n}\nasync function writeJSON(object, filename) {\n  try {\n    const allObjects = await readJSON(filename);\n    allObjects.push(object);\n    await fs.writeFile(filename, JSON.stringify(allObjects), 'utf8');\n    return allObjects;\n  } catch (err) {\n    console.error(err);\n    throw err;\n  }\n}\nasync function register(req, res) {\n  try {\n    const email = req.body.email;\n    const username = req.body.username;\n    const password = req.body.password;\n    if (!email.includes('@') || !email.includes('.') || password.length < 6) {\n      return res.status(500).json({\n        message: 'Validation error'\n      });\n    } else if (username.length < 6) {\n      return res.status(500).json({\n        message: 'Username must be at least 6 characters long'\n      });\n    } else {\n      const newUser = new User(email, username, password);\n      const updatedUsers = await writeJSON(newUser, 'utils/users.json');\n      return res.status(201).json(updatedUsers);\n    }\n  } catch (error) {\n    return res.status(500).json({\n      message: error.message\n    });\n  }\n}\nasync function login(req, res) {\n  try {\n    const email = req.body.email;\n    const password = req.body.password;\n    const allUsers = await readJSON('utils/users.json');\n    var validCredentials = false;\n    for (var i = 0; i < allUsers.length; i++) {\n      var nowUser = allUsers[i];\n      if (nowUser.email == email && nowUser.password == password) validCredentials = true;\n    }\n    if (validCredentials) {\n      return res.status(201).json({\n        message: 'Login successful!'\n      });\n    } else {\n      return res.status(500).json({\n        message: 'Invalid credentials!'\n      });\n    }\n  } catch (error) {\n    return res.status(500).json({\n      message: error.message\n    });\n  }\n}\nasync function getAllUsers(req, res) {\n  try {\n    const allResources = await readJSON('utils/users.json');\n    return res.status(201).json(allResources);\n  } catch (error) {\n    return res.status(500).json({\n      message: error.message\n    });\n  }\n}\nmodule.exports = {\n  readJSON,\n  writeJSON,\n  register,\n  login,\n  getAllUsers\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJVc2VyIiwicmVxdWlyZSIsImZzIiwicHJvbWlzZXMiLCJyZWFkSlNPTiIsImZpbGVuYW1lIiwiZGF0YSIsInJlYWRGaWxlIiwiSlNPTiIsInBhcnNlIiwiZXJyIiwiY29uc29sZSIsImVycm9yIiwid3JpdGVKU09OIiwib2JqZWN0IiwiYWxsT2JqZWN0cyIsInB1c2giLCJ3cml0ZUZpbGUiLCJzdHJpbmdpZnkiLCJyZWdpc3RlciIsInJlcSIsInJlcyIsImVtYWlsIiwiYm9keSIsInVzZXJuYW1lIiwicGFzc3dvcmQiLCJpbmNsdWRlcyIsImxlbmd0aCIsInN0YXR1cyIsImpzb24iLCJtZXNzYWdlIiwibmV3VXNlciIsInVwZGF0ZWRVc2VycyIsImxvZ2luIiwiYWxsVXNlcnMiLCJ2YWxpZENyZWRlbnRpYWxzIiwiaSIsIm5vd1VzZXIiLCJnZXRBbGxVc2VycyIsImFsbFJlc291cmNlcyIsIm1vZHVsZSIsImV4cG9ydHMiXSwic291cmNlUm9vdCI6IkM6XFxVc2Vyc1xcdGVpamlcXFRQIFllYXIgMi0zIENvZGluZyBQcm9qZWN0c1xcRGV2T3BzIFkyXFxCb29rTGFoXFx1dGlsc1xcIiwic291cmNlcyI6WyJ1c2VyVXRpbC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCB7VXNlcn09cmVxdWlyZSgnLi4vbW9kZWxzL1VzZXInKTtcclxuY29uc3QgZnMgPSByZXF1aXJlKCdmcycpLnByb21pc2VzO1xyXG5cclxuYXN5bmMgZnVuY3Rpb24gcmVhZEpTT04oZmlsZW5hbWUpe1xyXG4gICAgdHJ5e1xyXG4gICAgICAgIGNvbnN0IGRhdGEgPWF3YWl0IGZzLnJlYWRGaWxlKGZpbGVuYW1lLCAndXRmOCcpO1xyXG4gICAgICAgIHJldHVybiBKU09OLnBhcnNlKGRhdGEpO1xyXG4gICAgfWNhdGNoKGVycil7Y29uc29sZS5lcnJvcihlcnIpO3Rocm93IGVycjt9XHJcbn1cclxuXHJcbmFzeW5jIGZ1bmN0aW9uIHdyaXRlSlNPTihvYmplY3QsZmlsZW5hbWUpe1xyXG4gICAgdHJ5e1xyXG4gICAgICAgIGNvbnN0IGFsbE9iamVjdHM9YXdhaXQgcmVhZEpTT04oZmlsZW5hbWUpO1xyXG4gICAgICAgIGFsbE9iamVjdHMucHVzaChvYmplY3QpO1xyXG5cclxuICAgICAgICBhd2FpdCBmcy53cml0ZUZpbGUoZmlsZW5hbWUsSlNPTi5zdHJpbmdpZnkoYWxsT2JqZWN0cyksJ3V0ZjgnKTtcclxuICAgICAgICByZXR1cm4gYWxsT2JqZWN0cztcclxuICAgIH1jYXRjaChlcnIpe2NvbnNvbGUuZXJyb3IoZXJyKTt0aHJvdyBlcnI7fVxyXG59XHJcbmFzeW5jIGZ1bmN0aW9uIHJlZ2lzdGVyKHJlcSwgcmVzKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGVtYWlsID0gcmVxLmJvZHkuZW1haWw7XHJcbiAgICAgICAgY29uc3QgdXNlcm5hbWUgPSByZXEuYm9keS51c2VybmFtZTtcclxuICAgICAgICBjb25zdCBwYXNzd29yZCA9IHJlcS5ib2R5LnBhc3N3b3JkO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGlmICghZW1haWwuaW5jbHVkZXMoJ0AnKSB8fCAhZW1haWwuaW5jbHVkZXMoJy4nKSB8fCBwYXNzd29yZC5sZW5ndGggPCA2KSB7XHJcbiAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDUwMCkuanNvbih7IG1lc3NhZ2U6ICdWYWxpZGF0aW9uIGVycm9yJyB9KTtcclxuICAgICAgICB9IGVsc2UgaWYgKHVzZXJuYW1lLmxlbmd0aCA8IDYpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgbWVzc2FnZTogJ1VzZXJuYW1lIG11c3QgYmUgYXQgbGVhc3QgNiBjaGFyYWN0ZXJzIGxvbmcnIH0pO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGNvbnN0IG5ld1VzZXIgPSBuZXcgVXNlcihlbWFpbCx1c2VybmFtZSwgcGFzc3dvcmQpO1xyXG4gICAgICAgICAgICBjb25zdCB1cGRhdGVkVXNlcnMgPSBhd2FpdCB3cml0ZUpTT04obmV3VXNlciwgJ3V0aWxzL3VzZXJzLmpzb24nKTtcclxuICAgICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAxKS5qc29uKHVwZGF0ZWRVc2Vycyk7XHJcbiAgICAgICAgfVxyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg1MDApLmpzb24oeyBtZXNzYWdlOiBlcnJvci5tZXNzYWdlIH0pO1xyXG4gICAgfVxyXG59XHJcbmFzeW5jIGZ1bmN0aW9uIGxvZ2luKHJlcSwgcmVzKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGVtYWlsID0gcmVxLmJvZHkuZW1haWw7XHJcbiAgICAgICAgY29uc3QgcGFzc3dvcmQgPSByZXEuYm9keS5wYXNzd29yZDtcclxuICAgICAgICBjb25zdCBhbGxVc2VycyA9IGF3YWl0IHJlYWRKU09OKCd1dGlscy91c2Vycy5qc29uJyk7XHJcbiAgICAgICAgdmFyIHZhbGlkQ3JlZGVudGlhbHMgPSBmYWxzZTtcclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFsbFVzZXJzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIHZhciBub3dVc2VyID0gYWxsVXNlcnNbaV07XHJcbiAgICAgICAgICAgIGlmIChub3dVc2VyLmVtYWlsID09IGVtYWlsICYmIG5vd1VzZXIucGFzc3dvcmQgPT0gcGFzc3dvcmQpXHJcbiAgICAgICAgICAgIHZhbGlkQ3JlZGVudGlhbHMgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodmFsaWRDcmVkZW50aWFscykge1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cygyMDEpLmpzb24oeyBtZXNzYWdlOiAnTG9naW4gc3VjY2Vzc2Z1bCEnIH0pO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDUwMCkuanNvbih7IG1lc3NhZ2U6ICdJbnZhbGlkIGNyZWRlbnRpYWxzIScgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg1MDApLmpzb24oeyBtZXNzYWdlOiBlcnJvci5tZXNzYWdlIH0pO1xyXG4gICAgfVxyXG59XHJcbmFzeW5jIGZ1bmN0aW9uIGdldEFsbFVzZXJzKHJlcSwgcmVzKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCBhbGxSZXNvdXJjZXMgPSBhd2FpdCByZWFkSlNPTigndXRpbHMvdXNlcnMuanNvbicpO1xyXG4gICAgICByZXR1cm4gcmVzLnN0YXR1cygyMDEpLmpzb24oYWxsUmVzb3VyY2VzKTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDUwMCkuanNvbih7IG1lc3NhZ2U6IGVycm9yLm1lc3NhZ2UgfSk7XHJcbiAgICB9XHJcbiAgfVxyXG5tb2R1bGUuZXhwb3J0cz17XHJcbiAgICByZWFkSlNPTix3cml0ZUpTT04scmVnaXN0ZXIsbG9naW4sZ2V0QWxsVXNlcnNcclxufVxyXG4iXSwibWFwcGluZ3MiOiJBQUFBLE1BQU07RUFBQ0E7QUFBSSxDQUFDLEdBQUNDLE9BQU8sQ0FBQyxnQkFBZ0IsQ0FBQztBQUN0QyxNQUFNQyxFQUFFLEdBQUdELE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQ0UsUUFBUTtBQUVqQyxlQUFlQyxRQUFRQSxDQUFDQyxRQUFRLEVBQUM7RUFDN0IsSUFBRztJQUNDLE1BQU1DLElBQUksR0FBRSxNQUFNSixFQUFFLENBQUNLLFFBQVEsQ0FBQ0YsUUFBUSxFQUFFLE1BQU0sQ0FBQztJQUMvQyxPQUFPRyxJQUFJLENBQUNDLEtBQUssQ0FBQ0gsSUFBSSxDQUFDO0VBQzNCLENBQUMsUUFBTUksR0FBRyxFQUFDO0lBQUNDLE9BQU8sQ0FBQ0MsS0FBSyxDQUFDRixHQUFHLENBQUM7SUFBQyxNQUFNQSxHQUFHO0VBQUM7QUFDN0M7QUFFQSxlQUFlRyxTQUFTQSxDQUFDQyxNQUFNLEVBQUNULFFBQVEsRUFB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","map":{"version":3,"names":["User","require","fs","promises","readJSON","filename","data","readFile","JSON","parse","err","console","error","writeJSON","object","allObjects","push","writeFile","stringify","register","req","res","email","body","username","password","includes","length","status","json","message","newUser","updatedUsers","login","allUsers","validCredentials","i","nowUser","getAllUsers","allResources","module","exports"],"sourceRoot":"C:\\Users\\teiji\\TP Year 2-3 Coding Projects\\DevOps Y2\\BookLah\\utils\\","sources":["userUtil.js"],"sourcesContent":["const {User}=require('../models/User');\r\nconst fs = require('fs').promises;\r\n\r\nasync function readJSON(filename){\r\n    try{\r\n        const data =await fs.readFile(filename, 'utf8');\r\n        return JSON.parse(data);\r\n    }catch(err){console.error(err);throw err;}\r\n}\r\n\r\nasync function writeJSON(object,filename){\r\n    try{\r\n        const allObjects=await readJSON(filename);\r\n        allObjects.push(object);\r\n\r\n        await fs.writeFile(filename,JSON.stringify(allObjects),'utf8');\r\n        return allObjects;\r\n    }catch(err){console.error(err);throw err;}\r\n}\r\nasync function register(req, res) {\r\n    try {\r\n        const email = req.body.email;\r\n        const username = req.body.username;\r\n        const password = req.body.password;\r\n        \r\n        if (!email.includes('@') || !email.includes('.') || password.length < 6) {\r\n            return res.status(500).json({ message: 'Validation error' });\r\n        } else if (username.length < 6) {\r\n            return res.status(500).json({ message: 'Username must be at least 6 characters long' });\r\n        } else {\r\n            const newUser = new User(email,username, password);\r\n            const updatedUsers = await writeJSON(newUser, 'utils/users.json');\r\n            return res.status(201).json(updatedUsers);\r\n        }\r\n    } catch (error) {\r\n        return res.status(500).json({ message: error.message });\r\n    }\r\n}\r\nasync function login(req, res) {\r\n    try {\r\n        const email = req.body.email;\r\n        const password = req.body.password;\r\n        const allUsers = await readJSON('utils/users.json');\r\n        var validCredentials = false;\r\n        for (var i = 0; i < allUsers.length; i++) {\r\n            var nowUser = allUsers[i];\r\n            if (nowUser.email == email && nowUser.password == password)\r\n            validCredentials = true;\r\n        }\r\n        if (validCredentials) {\r\n            return res.status(201).json({ message: 'Login successful!' });\r\n        } else {\r\n            return res.status(500).json({ message: 'Invalid credentials!' });\r\n        }\r\n    } catch (error) {\r\n        return res.status(500).json({ message: error.message });\r\n    }\r\n}\r\nasync function getAllUsers(req, res) {\r\n    try {\r\n      const allResources = await readJSON('utils/users.json');\r\n      return res.status(201).json(allResources);\r\n    } catch (error) {\r\n      return res.status(500).json({ message: error.message });\r\n    }\r\n  }\r\nmodule.exports={\r\n    readJSON,writeJSON,register,login,getAllUsers\r\n}\r\n"],"mappings":"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"}},"mtime":1700999288341},"{\"assumptions\":{},\"sourceRoot\":\"C:\\\\Users\\\\teiji\\\\TP Year 2-3 Coding Projects\\\\DevOps Y2\\\\BookLah\\\\models\\\\\",\"caller\":{\"name\":\"@babel/register\"},\"cwd\":\"C:\\\\Users\\\\teiji\\\\TP Year 2-3 Coding Projects\\\\DevOps Y2\\\\BookLah\",\"filename\":\"C:\\\\Users\\\\teiji\\\\TP Year 2-3 Coding Projects\\\\DevOps Y2\\\\BookLah\\\\models\\\\User.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"C:\\\\Users\\\\teiji\\\\TP Year 2-3 Coding Projects\\\\DevOps Y2\\\\BookLah\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.23.3:development":{"value":{"code":"class User {\n  constructor(email, username, password) {\n    this.email = email;\n    this.username = username;\n    this.password = password;\n  }\n}\nmodule.exports = {\n  User\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJVc2VyIiwiY29uc3RydWN0b3IiLCJlbWFpbCIsInVzZXJuYW1lIiwicGFzc3dvcmQiLCJtb2R1bGUiLCJleHBvcnRzIl0sInNvdXJjZVJvb3QiOiJDOlxcVXNlcnNcXHRlaWppXFxUUCBZZWFyIDItMyBDb2RpbmcgUHJvamVjdHNcXERldk9wcyBZMlxcQm9va0xhaFxcbW9kZWxzXFwiLCJzb3VyY2VzIjpbIlVzZXIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiY2xhc3MgVXNlcntcclxuICAgIGNvbnN0cnVjdG9yKGVtYWlsLHVzZXJuYW1lLHBhc3N3b3JkKXtcclxuICAgICAgICB0aGlzLmVtYWlsPWVtYWlsO1xyXG4gICAgICAgIHRoaXMudXNlcm5hbWU9dXNlcm5hbWU7XHJcbiAgICAgICAgdGhpcy5wYXNzd29yZD1wYXNzd29yZDtcclxuICAgIH1cclxufVxyXG5tb2R1bGUuZXhwb3J0cz17VXNlcn07Il0sIm1hcHBpbmdzIjoiQUFBQSxNQUFNQSxJQUFJO0VBQ05DLFdBQVdBLENBQUNDLEtBQUssRUFBQ0MsUUFBUSxFQUFDQyxRQUFRLEVBQUM7SUFDaEMsSUFBSSxDQUFDRixLQUFLLEdBQUNBLEtBQUs7SUFDaEIsSUFBSSxDQUFDQyxRQUFRLEdBQUNBLFFBQVE7SUFDdEIsSUFBSSxDQUFDQyxRQUFRLEdBQUNBLFFBQVE7RUFDMUI7QUFDSjtBQUNBQyxNQUFNLENBQUNDLE9BQU8sR0FBQztFQUFDTjtBQUFJLENBQUMifQ==","map":{"version":3,"names":["User","constructor","email","username","password","module","exports"],"sourceRoot":"C:\\Users\\teiji\\TP Year 2-3 Coding Projects\\DevOps Y2\\BookLah\\models\\","sources":["User.js"],"sourcesContent":["class User{\r\n    constructor(email,username,password){\r\n        this.email=email;\r\n        this.username=username;\r\n        this.password=password;\r\n    }\r\n}\r\nmodule.exports={User};"],"mappings":"AAAA,MAAMA,IAAI;EACNC,WAAWA,CAACC,KAAK,EAACC,QAAQ,EAACC,QAAQ,EAAC;IAChC,IAAI,CAACF,KAAK,GAACA,KAAK;IAChB,IAAI,CAACC,QAAQ,GAACA,QAAQ;IACtB,IAAI,CAACC,QAAQ,GAACA,QAAQ;EAC1B;AACJ;AACAC,MAAM,CAACC,OAAO,GAAC;EAACN;AAAI,CAAC"}},"mtime":1700406385490}}